PAvals <- read.csv("pvals_temp.csv")
PAvals
PAvals <- read.csv("pvals_temp.csv")
head(PAvals)
PAvals <- read.csv("pvals_temp.csv", row.names = 1)
PAvals <- read.csv("pvals_temp.csv")
head(PAvals)
ggplot(PAvals) + geom_point(aes(x=X.log10Pvalue, y=Pathway, color=Contrast)) + theme_bw()
require(ggplot2)
ggplot(PAvals) + geom_point(aes(x=X.log10Pvalue, y=Pathway, color=Contrast)) + theme_bw()
PAvals <- read.csv("pvals_temp.csv")
PAvals <- PAvals[PAvals$P.value < 0.05,]
head(PAvals)
require(ggplot2)
ggplot(PAvals) + geom_point(aes(x=X.log10Pvalue, y=Pathway, color=Contrast)) + theme_bw()
require(ggplot2)
ggplot(PAvals) + geom_point(aes(x=X.log10Pvalue, y=Pathway, color=Contrast)) + theme_bw() + facet_wrap(Contrast)
require(ggplot2)
ggplot(PAvals) + geom_point(aes(x=X.log10Pvalue, y=Pathway, color=Contrast)) + theme_bw() + facet_wrap('Contrast')
PAvals <- read.csv("pvals_temp.csv")
PAvals <- PAvals[PAvals$P.value < 0.05,]
head(PAvals)
require(ggplot2)
ggplot(PAvals) + geom_point(aes(x=X.log10Pvalue, y=Pathway, color=Contrast)) + theme_bw() + facet_wrap('Contrast')
require(ggplot2)
ggplot(PAvals) + geom_point(aes(x=X.log10Pvalue, y=`Pathway Name`, color=Contrast)) + theme_bw() + facet_wrap('Contrast')
require(ggplot2)
ggplot(PAvals) + geom_point(aes(x=X.log10Pvalue, y=Pathway.Name, color=Contrast)) + theme_bw() + facet_wrap('Contrast')
PAvals <- read.csv("pvals_temp.csv")
PAvals$BHpvals <- p.adjust(PAvals$P.value)
PAvals <- PAvals[PAvals$P.value < 0.05,]
PAvals$negativeLog10_adjpvals <- (-1)*log10(PAvals$BHpvals)
head(PAvals)
require(ggplot2)
ggplot(PAvals) + geom_point(aes(x=negativeLog10_adjpvals, y=Pathway.Name, color=Contrast)) + theme_bw() + facet_wrap('Contrast')
PAvals <- read.csv("pvals_temp.csv")
PAvals$BHpvals <- p.adjust(PAvals$P.value)
PAvals <- PAvals[PAvals$P.value < 0.05,]
PAvals
PAvals <- read.csv("pvals_temp.csv")
PAvals$BHpvals <- p.adjust(PAvals$P.value)
PAvals <- PAvals[PAvals$P.value < 0.05,]
PAvals$negativeLog10_adjpvals <- (-1)*log10(PAvals$BHpvals)
PAvals <- na.omit(PAvals)
head(PAvals)
require(ggplot2)
ggplot(PAvals) + geom_point(aes(x=negativeLog10_adjpvals, y=Pathway.Name, color=Contrast)) + theme_bw() + facet_wrap('Contrast')
require(ggplot2)
ggplot(PAvals) + geom_point(aes(x=negativeLog10_adjpvals, y=Pathway.Name, color=Contrast)) + theme_bw() + facet_wrap('Contrast') + xlab("-log10 (BH-corrected P value)") + ylab("Pathway Name")
PAvals <- read.csv("pvals_temp.csv")
PAvals$BHpvals <- p.adjust(PAvals$P.value)
#PAvals <- PAvals[PAvals$P.value < 0.05,]
PAvals$negativeLog10_adjpvals <- (-1)*log10(PAvals$BHpvals)
PAvals <- na.omit(PAvals)
head(PAvals)
require(ggplot2)
ggplot(PAvals) + geom_point(aes(x=negativeLog10_adjpvals, y=Pathway.Name, color=Contrast)) + theme_bw() + facet_wrap('Contrast') + xlab("-log10 (BH-corrected P value)") + ylab("Pathway Name")
PAvals <- read.csv("pvals_temp.csv")
PAvals$BHpvals <- p.adjust(PAvals$P.value)
PAvals <- PAvals[PAvals$P.value < 0.05,]
PAvals$negativeLog10_adjpvals <- (-1)*log10(PAvals$BHpvals)
PAvals <- na.omit(PAvals)
head(PAvals)
require(ggplot2)
ggplot(PAvals) + geom_point(aes(x=negativeLog10_adjpvals, y=Pathway.Name, color=Contrast)) + theme_bw() + facet_wrap('Contrast') + xlab("-log10 (BH-corrected P value)") + ylab("Pathway Name")
PAvals <- read.csv("pvals_temp.csv")
PAvals$BHpvals <- p.adjust(PAvals$P.value)
PAvals <- PAvals[PAvals$BHpvals < 0.05,]
PAvals$negativeLog10_adjpvals <- (-1)*log10(PAvals$BHpvals)
PAvals <- na.omit(PAvals)
head(PAvals)
require(ggplot2)
ggplot(PAvals) + geom_point(aes(x=negativeLog10_adjpvals, y=Pathway.Name, color=Contrast)) + theme_bw() + facet_wrap('Contrast') + xlab("-log10 (BH-corrected P value)") + ylab("Pathway Name")
PAvals <- read.csv("pvals_temp.csv")
PAvals$BHpvals <- p.adjust(PAvals$P.value)
PAvals <- PAvals[PAvals$BHpvals < 0.05,]
PAvals$negativeLog10_adjpvals <- (-1)*log10(PAvals$BHpvals)
PAvals <- na.omit(PAvals)
head(PAvals)
require(ggplot2)
ggplot(PAvals) + geom_point(aes(x=negativeLog10_adjpvals, y=Pathway.Name, color=Contrast)) + theme_bw() + facet_wrap('Contrast') + xlab("-log10 (BH-corrected P value)") + ylab("Pathway Name")
require(ggplot2)
ggplot(PAvals) + geom_point(aes(x=negativeLog10_adjpvals, y=Pathway.Name, color=Contrast)) + theme_bw() + facet_wrap('Contrast') + xlab("-log10 (BH-corrected P value)") + ylab("Pathway Name") + xlim(0, max(PAvals$negativeLog10_adjpvals))
require(ggplot2)
require(ggpubr)
ggplot(PAvals) + geom_point(aes(x=negativeLog10_adjpvals, y=Pathway.Name, color=Contrast)) + theme_bw() + facet_wrap('Contrast') + xlab("-log10 (BH-corrected P value)") + ylab("Pathway Name") + xlim(0, max(PAvals$negativeLog10_adjpvals)) + theme_pubr()
PAvals$Significant <- as.factor(unlist(lapply(PAvals$negativeLog10_adjpvals, function(x){if(x<1.303){return(FALSE)}else{return(TRUE)}})))
p1 <- ggplot(PAvals, aes(Method, Pathway, fill=Significant)) + geom_tile(color = 'black', size = 0.3) + facet_wrap(~Contrast, as.table=FALSE) + theme_pubr(base_size = 16) + rotate_x_text(90) + scale_fill_brewer()
PAvals$Significant <- as.factor(unlist(lapply(PAvals$negativeLog10_adjpvals, function(x){if(x<1.303){return(FALSE)}else{return(TRUE)}})))
p1 <- ggplot(PAvals, aes(Method, Pathway, fill=Significant)) + geom_tile(color = 'black', size = 0.3) + facet_wrap(~Contrast, as.table=FALSE) + theme_pubr(base_size = 16) + rotate_x_text(90) + scale_fill_brewer()
p1
PAvals$Significant <- as.factor(unlist(lapply(PAvals$negativeLog10_adjpvals, function(x){if(x<1.303){return(FALSE)}else{return(TRUE)}})))
p1 <- ggplot(PAvals, aes(Contrast, Pathway, fill=Significant)) + geom_tile(color = 'black', size = 0.3) + facet_wrap(~Contrast, as.table=FALSE) + theme_pubr(base_size = 16) + rotate_x_text(90) + scale_fill_brewer()
p1
PAvals
PAvals <- reshape2::acast(PAvals, Pathway ~ Contrast, value.var = 'negativeLog10_adjpvals')
PAvals[is.na(PAvals)] <- 0
PAvals$Significant <- as.factor(unlist(lapply(PAvals$negativeLog10_adjpvals, function(x){if(x<1.303){return(FALSE)}else{return(TRUE)}})))
PAvals
melt(PAvals)
reshape2::melt(PAvals)
PAvals <- reshape2::melt(reshape2::acast(PAvals, Pathway ~ Contrast, value.var = 'negativeLog10_adjpvals'))
PAvals <- read.csv("pvals_temp.csv")
PAvals$BHpvals <- p.adjust(PAvals$P.value)
PAvals <- PAvals[PAvals$BHpvals < 0.05,]
PAvals$negativeLog10_adjpvals <- (-1)*log10(PAvals$BHpvals)
PAvals <- na.omit(PAvals)
head(PAvals)
require(ggplot2)
require(ggpubr)
ggplot(PAvals) + geom_point(aes(x=negativeLog10_adjpvals, y=Pathway.Name, color=Contrast)) + theme_bw() + facet_wrap('Contrast') + xlab("-log10 (BH-corrected P value)") + ylab("Pathway Name") + xlim(0, max(PAvals$negativeLog10_adjpvals)) + theme_pubr()
PAvals <- reshape2::melt(reshape2::acast(PAvals, Pathway ~ Contrast, value.var = 'negativeLog10_adjpvals'))
PAvals[is.na(PAvals)] <- 0
PAvals
PAvals <- read.csv("pvals_temp.csv")
PAvals$BHpvals <- p.adjust(PAvals$P.value)
PAvals <- PAvals[PAvals$BHpvals < 0.05,]
PAvals$negativeLog10_adjpvals <- (-1)*log10(PAvals$BHpvals)
PAvals <- na.omit(PAvals)
head(PAvals)
PAvals <- reshape2::melt(reshape2::acast(PAvals, `Pathway Name` ~ Contrast, value.var = 'negativeLog10_adjpvals'))
PAvals <- reshape2::melt(reshape2::acast(PAvals, Pathway.Name ~ Contrast, value.var = 'negativeLog10_adjpvals'))
PAvals[is.na(PAvals)] <- 0
colnames(PAvals) <- c("Pathway Name", "Contrast", "negativeLog10_adjpvals")
PAvals$Significant <- as.factor(unlist(lapply(PAvals$negativeLog10_adjpvals, function(x){if(x<1.303){return(FALSE)}else{return(TRUE)}})))
p1 <- ggplot(PAvals, aes(Contrast, `Pathway Name`, fill=Significant)) + geom_tile(color = 'black', size = 0.3) + facet_wrap(~Contrast, as.table=FALSE) + theme_pubr(base_size = 16) + rotate_x_text(90) + scale_fill_brewer()
p1
PAvals$Significant <- as.factor(unlist(lapply(PAvals$negativeLog10_adjpvals, function(x){if(x<1.303){return(FALSE)}else{return(TRUE)}})))
p1 <- ggplot(PAvals, aes(Contrast, `Pathway Name`, fill=Significant)) + geom_tile(color = 'black', size = 0.3)  + theme_pubr(base_size = 16) + rotate_x_text(90) + scale_fill_brewer()
p1
PAvals$Significant <- as.factor(unlist(lapply(PAvals$negativeLog10_adjpvals, function(x){if(x<1.303){return(FALSE)}else{return(TRUE)}})))
p1 <- ggplot(PAvals, aes(y=`Pathway Name`, fill=Significant)) + geom_tile(color = 'black', size = 0.3) + facet_wrap(~Contrast, as.table=FALSE) + theme_pubr(base_size = 16) + rotate_x_text(90) + scale_fill_brewer()
p1
require(ggplot2)
require(ggpubr)
ggplot(PAvals) + geom_point(aes(x=negativeLog10_adjpvals, y=Pathway.Name, color=Contrast)) + theme_bw() + facet_wrap('Contrast') + xlab("-log10 (BH-corrected P value)") + ylab("Pathway Name") + xlim(0, max(PAvals$negativeLog10_adjpvals)) + theme_pubr()
PAvals <- read.csv("pvals_temp.csv")
PAvals$BHpvals <- p.adjust(PAvals$P.value)
PAvals <- PAvals[PAvals$BHpvals < 0.05,]
PAvals$negativeLog10_adjpvals <- (-1)*log10(PAvals$BHpvals)
PAvals <- na.omit(PAvals)
head(PAvals)
PAvals <- reshape2::melt(reshape2::acast(PAvals, Pathway.Name ~ Contrast, value.var = 'negativeLog10_adjpvals'))
PAvals[is.na(PAvals)] <- 0
colnames(PAvals) <- c("Pathway Name", "Contrast", "negativeLog10_adjpvals")
PAvals$Significant <- as.factor(unlist(lapply(PAvals$negativeLog10_adjpvals, function(x){if(x<1.303){return(FALSE)}else{return(TRUE)}})))
p1 <- ggplot(PAvals, aes(y=`Pathway Name`, fill=Significant)) + geom_tile(color = 'black', size = 0.3) + facet_wrap(~Contrast, as.table=FALSE) + theme_pubr(base_size = 16) + rotate_x_text(90) + scale_fill_brewer()
p1
p1 <- ggplot(PAvals, aes(`Pathway Name`, fill=Significant)) + geom_tile(color = 'black', size = 0.3) + facet_wrap(~Contrast, as.table=FALSE) + theme_pubr(base_size = 16) + rotate_x_text(90) + scale_fill_brewer()
p1
PAvals$Significant <- as.factor(unlist(lapply(PAvals$negativeLog10_adjpvals, function(x){if(x<1.303){return(FALSE)}else{return(TRUE)}})))
p1 <- ggplot(PAvals, aes(Contrast, `Pathway Name`, fill=Significant)) + geom_tile(color = 'black', size = 0.3)  + theme_pubr(base_size = 16) + rotate_x_text(90) + scale_fill_brewer()
p1
PAvals$Significant <- as.factor(unlist(lapply(PAvals$negativeLog10_adjpvals, function(x){if(x<1.303){return(FALSE)}else{return(TRUE)}})))
p1 <- ggplot(PAvals, aes(Contrast, `Pathway Name`, fill=Significant)) + geom_tile(color = 'black', size = 0.3) + facet_wrap(~Contrast, as.table=FALSE) + theme_pubr(base_size = 16) + rotate_x_text(90) + scale_fill_brewer()
p1
PAvals$Significant <- as.factor(unlist(lapply(PAvals$negativeLog10_adjpvals, function(x){if(x<1.303){return(FALSE)}else{return(TRUE)}})))
p1 <- ggplot(PAvals, aes(`Pathway Name`, fill=Significant)) + geom_tile(color = 'black', size = 0.3) + facet_wrap(~Contrast, as.table=FALSE) + theme_pubr(base_size = 16) + rotate_x_text(90) + scale_fill_brewer()
p1
PAvals$Significant <- as.factor(unlist(lapply(PAvals$negativeLog10_adjpvals, function(x){if(x<1.303){return(FALSE)}else{return(TRUE)}})))
p1 <- ggplot(PAvals, aes(Contrast, `Pathway Name`, fill=Significant)) + geom_tile(color = 'black', size = 0.3) + facet_wrap(~Contrast, as.table=FALSE) + theme_pubr(base_size = 16) + rotate_x_text(90) + scale_fill_brewer()
p1
PAvals$Significant <- as.factor(unlist(lapply(PAvals$negativeLog10_adjpvals, function(x){if(x<1.303){return(FALSE)}else{return(TRUE)}})))
p1 <- ggplot(PAvals, aes(Contrast, `Pathway Name`, fill=Significant)) + geom_tile(color = 'black', size = 0.3) +scale_x_discrete(position = "top") + theme_pubr(base_size = 16) + rotate_x_text(90) + scale_fill_brewer()
p1
PAvals$Significant <- as.factor(unlist(lapply(PAvals$negativeLog10_adjpvals, function(x){if(x<1.303){return(FALSE)}else{return(TRUE)}})))
p1 <- ggplot(PAvals, aes(Contrast, `Pathway Name`, fill=Significant)) + geom_tile(color = 'black', size = 0.3) +scale_x_discrete(position = "top") + theme_pubr(base_size = 16) + rotate_x_text(0) + scale_fill_brewer()
p1
PAvals$Significant <- as.factor(unlist(lapply(PAvals$negativeLog10_adjpvals, function(x){if(x<1.303){return(FALSE)}else{return(TRUE)}})))
p1 <- ggplot(PAvals, aes(Contrast, `Pathway Name`, fill=Significant)) + geom_tile(color = 'black', size = 0.3) + scale_x_discrete(position = "top") + theme_pubr(base_size = 16) + rotate_x_text(90) + scale_fill_brewer()
p1
PAvals$Significant <- as.factor(unlist(lapply(PAvals$negativeLog10_adjpvals, function(x){if(x<1.303){return(FALSE)}else{return(TRUE)}})))
p1 <- ggplot(PAvals, aes(Contrast, `Pathway Name`, fill=Significant)) + geom_tile(color = 'black', size = 0.3) + scale_x_discrete(position = "top") + theme_pubr(base_size = 16) + rotate_x_text(0) + scale_fill_brewer()
p1
PAvals$Significant <- as.factor(unlist(lapply(PAvals$negativeLog10_adjpvals, function(x){if(x<1.303){return(FALSE)}else{return(TRUE)}})))
p1 <- ggplot(PAvals, aes(Contrast, `Pathway Name`, fill=Significant)) + geom_tile(color = 'black', size = 0.3) + scale_x_discrete(position = "top") + theme_pubr(base_size = 16) + rotate_x_text(0) + scale_fill_brewer()
png(
"mBONITA_pvalues.png",
width = 12,
height = 4,
units = "in",
res = 600
)
p1
dev.off()
PAvals$Contrast
PAvals$Significant <- as.factor(unlist(lapply(PAvals$negativeLog10_adjpvals, function(x){if(x<1.303){return(FALSE)}else{return(TRUE)}})))
PAvals$Contrast <- gsub(" vs ", "\nvs\n", PAvals$Contrast)
p1 <- ggplot(PAvals, aes(Contrast, `Pathway Name`, fill=Significant)) + geom_tile(color = 'black', size = 0.3) + scale_x_discrete(position = "top") + theme_pubr(base_size = 16) + rotate_x_text(0) + scale_fill_brewer()
png(
"mBONITA_pvalues.png",
width = 12,
height = 4,
units = "in",
res = 600
)
p1
dev.off()
p1
PAvals$Significant <- as.factor(unlist(lapply(PAvals$negativeLog10_adjpvals, function(x){if(x<1.303){return(FALSE)}else{return(TRUE)}})))
PAvals$Contrast <- gsub(" vs ", "\nvs\n", PAvals$Contrast)
p1 <- ggplot(PAvals, aes(Contrast, `Pathway Name`, fill=Significant)) + geom_tile(color = 'black', size = 0.3) + scale_x_discrete(position = "top") + theme_pubr(base_size = 16) + rotate_x_text(0) + scale_fill_brewer() + xlab("")
png(
"mBONITA_pvalues.png",
width = 12,
height = 4,
units = "in",
res = 600
)
p1
dev.off()
PAvals$Significant <- as.factor(unlist(lapply(PAvals$negativeLog10_adjpvals, function(x){if(x<1.303){return(FALSE)}else{return(TRUE)}})))
PAvals$Contrast <- gsub(" vs ", "\nvs\n", PAvals$Contrast)
p1 <- ggplot(PAvals, aes(Contrast, `Pathway Name`, fill=Significant)) + geom_tile(color = 'black', size = 0.3) + scale_x_discrete(position = "top") + theme_pubr(base_size = 16) + rotate_x_text(0) + scale_fill_brewer() + xlab("")
png(
"mBONITA_pvalues.png",
width = 12,
height = 4,
units = "in",
res = 600
)
p1
dev.off()
svg(
"mBONITA_pvalues.svg",
width = 12,
height = 4,
units = "in"
)
PAvals$Significant <- as.factor(unlist(lapply(PAvals$negativeLog10_adjpvals, function(x){if(x<1.303){return(FALSE)}else{return(TRUE)}})))
PAvals$Contrast <- gsub(" vs ", "\nvs\n", PAvals$Contrast)
p1 <- ggplot(PAvals, aes(Contrast, `Pathway Name`, fill=Significant)) + geom_tile(color = 'black', size = 0.3) + scale_x_discrete(position = "top") + theme_pubr(base_size = 16) + rotate_x_text(0) + scale_fill_brewer() + xlab("")
png(
"mBONITA_pvalues.png",
width = 12,
height = 4,
units = "in",
res = 600
)
p1
dev.off()
svg(
"mBONITA_pvalues.svg",
width = 12,
height = 4
)
p1
dev.off()
