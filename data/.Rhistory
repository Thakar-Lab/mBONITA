PAlist2$Method <- 'Combined'
PAlist2 <- reshape2::acast(PAlist2, Pathway + Contrast ~ Algorithm , value.var = 'negativelog10FDR')
PAlist2[is.na(PAlist2)] <- 0
PAlist2 <- as.data.frame(apply(PAlist2, c(1,2), FUN=function(x){if(x>1.303){return(TRUE)}else{return(FALSE)}}))
PAlist2$Pathway <- gsub("\\_.*", "", rownames(PAlist2))
PAlist2$Contrast <- gsub(".*\\_", "", rownames(PAlist2))
#PAlist2 <- reshape2::melt(PAlist2)
#colnames(PAlist2) <- c("Pathway", "Algorithm", "Contrast", "negativelog10FDR")
head(PAlist2)
ComplexUpset::upset(
PAlist2,
colnames(PAlist2)[1:5],
base_annotations=list(
'Intersection Size'=intersection_size(mode = 'intersect' , bar_number_threshold=0.45, text_colors = c(on_background = "black", on_bar = "black"), size=0, mapping=aes(fill=Contrast, label=Contrast), position = position_dodge(), text_mapping = aes(colour=Contrast),
text = list(position=position_stack())
) + ylim(0, 150) + scale_fill_manual(values=c(
"1% O2, CyA+ vs 1% O2, CyA-"='#E41A1C', "19% O2, CyA- vs 1% O2, CyA+"='#377EB8',
"1% O2, CyA- vs 19% O2, CyA-"='#4DAF4A'
))
) ,
width_ratio=0.3,
set_sizes=(upset_set_size(position='right',geom=geom_bar(stat='count', position = position_dodge(),aes(fill=Contrast)))+ scale_fill_discrete(guide='none')),
# moves legends over the set sizes
guides='over'
)
require(ComplexUpset)
PAlist2 <- lapply(PAlist, function(x){return(x[x$Method %in% c("Concatenated", "Combined", "mBONITA"), intersect(colnames(x), c('Contrast', 'Pathway',"Method", 'negativelog10FDR'))])}) #lapply(PAlist, function(x){return(x[x$Pathway %in% gmt$Pathway & x$Method %in% c("Concatenated", "Combined"), intersect(colnames(x), c('Contrast', 'Pathway',"Method", 'negativelog10FDR'))])})
PAlist2$Pathway <- unlist(lapply(PAlist2$Pathway, function(x){if(x %in% gmt$Pathway){return(paste0(x, "**"))}}))
PAlist2 <- Filter(function(x) dim(x)[1] > 0, PAlist2)
for (i in names(PAlist2)){
PAlist2[[i]]$Algorithm <- i
}
PAlist2 <- do.call(rbind,PAlist2)
rownames(PAlist2) <- 1:nrow(PAlist2)
PAlist2$Method <- 'Combined'
PAlist2 <- reshape2::acast(PAlist2, Pathway + Contrast ~ Algorithm , value.var = 'negativelog10FDR')
PAlist2[is.na(PAlist2)] <- 0
PAlist2 <- as.data.frame(apply(PAlist2, c(1,2), FUN=function(x){if(x>1.303){return(TRUE)}else{return(FALSE)}}))
PAlist2$Pathway <- gsub("\\_.*", "", rownames(PAlist2))
PAlist2$Contrast <- gsub(".*\\_", "", rownames(PAlist2))
#PAlist2 <- reshape2::melt(PAlist2)
#colnames(PAlist2) <- c("Pathway", "Algorithm", "Contrast", "negativelog10FDR")
head(PAlist2)
ComplexUpset::upset(
PAlist2,
colnames(PAlist2)[1:5],
base_annotations=list(
'Intersection Size'=intersection_size(mode = 'intersect' , bar_number_threshold=0.45, text_colors = c(on_background = "black", on_bar = "black"), size=0, mapping=aes(fill=Contrast, label=Contrast), position = position_dodge(), text_mapping = aes(colour=Contrast),
text = list(position=position_stack())
) + ylim(0, 150) + scale_fill_manual(values=c(
"1% O2, CyA+ vs 1% O2, CyA-"='#E41A1C', "19% O2, CyA- vs 1% O2, CyA+"='#377EB8',
"1% O2, CyA- vs 19% O2, CyA-"='#4DAF4A'
)) + scale_color_manual(values=c(
"1% O2, CyA+ vs 1% O2, CyA-"='#E41A1C', "19% O2, CyA- vs 1% O2, CyA+"='#377EB8',
"1% O2, CyA- vs 19% O2, CyA-"='#4DAF4A'
))
) ,
width_ratio=0.3,
set_sizes=(upset_set_size(position='right',geom=geom_bar(stat='count', position = position_dodge(),aes(fill=Contrast)))+ scale_fill_discrete(guide='none')),
# moves legends over the set sizes
guides='over'
)
require(ComplexUpset)
PAlist2 <- lapply(PAlist, function(x){return(x[x$Method %in% c("Concatenated", "Combined", "mBONITA"), intersect(colnames(x), c('Contrast', 'Pathway',"Method", 'negativelog10FDR'))])}) #lapply(PAlist, function(x){return(x[x$Pathway %in% gmt$Pathway & x$Method %in% c("Concatenated", "Combined"), intersect(colnames(x), c('Contrast', 'Pathway',"Method", 'negativelog10FDR'))])})
PAlist2$Pathway <- unlist(lapply(PAlist2$Pathway, function(x){if(x %in% gmt$Pathway){return(paste0(x, "**"))}}))
PAlist2 <- Filter(function(x) dim(x)[1] > 0, PAlist2)
for (i in names(PAlist2)){
PAlist2[[i]]$Algorithm <- i
}
PAlist2 <- do.call(rbind,PAlist2)
rownames(PAlist2) <- 1:nrow(PAlist2)
PAlist2$Method <- 'Combined'
PAlist2 <- reshape2::acast(PAlist2, Pathway + Contrast ~ Algorithm , value.var = 'negativelog10FDR')
PAlist2[is.na(PAlist2)] <- 0
PAlist2 <- as.data.frame(apply(PAlist2, c(1,2), FUN=function(x){if(x>1.303){return(TRUE)}else{return(FALSE)}}))
PAlist2$Pathway <- gsub("\\_.*", "", rownames(PAlist2))
PAlist2$Contrast <- gsub(".*\\_", "", rownames(PAlist2))
#PAlist2 <- reshape2::melt(PAlist2)
#colnames(PAlist2) <- c("Pathway", "Algorithm", "Contrast", "negativelog10FDR")
head(PAlist2)
ComplexUpset::upset(
PAlist2,
colnames(PAlist2)[1:5],
base_annotations=list(
'Intersection Size'=intersection_size(mode = 'intersect' , bar_number_threshold=0.45, text_colors = c(on_background = "black", on_bar = "black"), size=0, mapping=aes(fill=Contrast, label=Contrast), position = position_dodge(), text_mapping = aes(label = Contrast, colour=Contrast),
text = list(position=position_stack())
) + ylim(0, 150) + scale_fill_manual(values=c(
"1% O2, CyA+ vs 1% O2, CyA-"='#E41A1C', "19% O2, CyA- vs 1% O2, CyA+"='#377EB8',
"1% O2, CyA- vs 19% O2, CyA-"='#4DAF4A'
)) + scale_color_manual(values=c(
"1% O2, CyA+ vs 1% O2, CyA-"='#E41A1C', "19% O2, CyA- vs 1% O2, CyA+"='#377EB8',
"1% O2, CyA- vs 19% O2, CyA-"='#4DAF4A'
))
) ,
width_ratio=0.3,
set_sizes=(upset_set_size(position='right',geom=geom_bar(stat='count', position = position_dodge(),aes(fill=Contrast)))+ scale_fill_discrete(guide='none')),
# moves legends over the set sizes
guides='over'
)
require(ComplexUpset)
PAlist2 <- lapply(PAlist, function(x){return(x[x$Method %in% c("Concatenated", "Combined", "mBONITA"), intersect(colnames(x), c('Contrast', 'Pathway',"Method", 'negativelog10FDR'))])}) #lapply(PAlist, function(x){return(x[x$Pathway %in% gmt$Pathway & x$Method %in% c("Concatenated", "Combined"), intersect(colnames(x), c('Contrast', 'Pathway',"Method", 'negativelog10FDR'))])})
PAlist2$Pathway <- unlist(lapply(PAlist2$Pathway, function(x){if(x %in% gmt$Pathway){return(paste0(x, "**"))}}))
PAlist2 <- Filter(function(x) dim(x)[1] > 0, PAlist2)
for (i in names(PAlist2)){
PAlist2[[i]]$Algorithm <- i
}
PAlist2 <- do.call(rbind,PAlist2)
rownames(PAlist2) <- 1:nrow(PAlist2)
PAlist2$Method <- 'Combined'
PAlist2 <- reshape2::acast(PAlist2, Pathway + Contrast ~ Algorithm , value.var = 'negativelog10FDR')
PAlist2[is.na(PAlist2)] <- 0
PAlist2 <- as.data.frame(apply(PAlist2, c(1,2), FUN=function(x){if(x>1.303){return(TRUE)}else{return(FALSE)}}))
PAlist2$Pathway <- gsub("\\_.*", "", rownames(PAlist2))
PAlist2$Contrast <- gsub(".*\\_", "", rownames(PAlist2))
#PAlist2 <- reshape2::melt(PAlist2)
#colnames(PAlist2) <- c("Pathway", "Algorithm", "Contrast", "negativelog10FDR")
head(PAlist2)
ComplexUpset::upset(
PAlist2,
colnames(PAlist2)[1:5],
base_annotations=list(
'Intersection Size'=intersection_size(mode = 'intersect' , bar_number_threshold=0.45, text_colors = c(on_background = "black", on_bar = "black"), size=0, mapping=aes(fill=Contrast), position = 'stack' #, #text_mapping = aes(colour=Contrast),
#text = list(position=position_stack())
) + ylim(0, 150) + scale_fill_manual(values=c(
"1% O2, CyA+ vs 1% O2, CyA-"='#E41A1C', "19% O2, CyA- vs 1% O2, CyA+"='#377EB8',
"1% O2, CyA- vs 19% O2, CyA-"='#4DAF4A'
)) + scale_color_manual(values=c(
"1% O2, CyA+ vs 1% O2, CyA-"='#E41A1C', "19% O2, CyA- vs 1% O2, CyA+"='#377EB8',
"1% O2, CyA- vs 19% O2, CyA-"='#4DAF4A'
))
) ,
width_ratio=0.3,
set_sizes=(upset_set_size(position='right',geom=geom_bar(stat='count', position = position_dodge(),aes(fill=Contrast)))+ scale_fill_discrete(guide='none')),
# moves legends over the set sizes
guides='over'
)
require(ComplexUpset)
PAlist2 <- lapply(PAlist, function(x){return(x[x$Method %in% c("Concatenated", "Combined", "mBONITA"), intersect(colnames(x), c('Contrast', 'Pathway',"Method", 'negativelog10FDR'))])}) #lapply(PAlist, function(x){return(x[x$Pathway %in% gmt$Pathway & x$Method %in% c("Concatenated", "Combined"), intersect(colnames(x), c('Contrast', 'Pathway',"Method", 'negativelog10FDR'))])})
PAlist2$Pathway <- unlist(lapply(PAlist2$Pathway, function(x){if(x %in% gmt$Pathway){return(paste0(x, "**"))}}))
PAlist2 <- Filter(function(x) dim(x)[1] > 0, PAlist2)
for (i in names(PAlist2)){
PAlist2[[i]]$Algorithm <- i
}
PAlist2 <- do.call(rbind,PAlist2)
rownames(PAlist2) <- 1:nrow(PAlist2)
PAlist2$Method <- 'Combined'
PAlist2 <- reshape2::acast(PAlist2, Pathway + Contrast ~ Algorithm , value.var = 'negativelog10FDR')
PAlist2[is.na(PAlist2)] <- 0
PAlist2 <- as.data.frame(apply(PAlist2, c(1,2), FUN=function(x){if(x>1.303){return(TRUE)}else{return(FALSE)}}))
PAlist2$Pathway <- gsub("\\_.*", "", rownames(PAlist2))
PAlist2$Contrast <- gsub(".*\\_", "", rownames(PAlist2))
#PAlist2 <- reshape2::melt(PAlist2)
#colnames(PAlist2) <- c("Pathway", "Algorithm", "Contrast", "negativelog10FDR")
head(PAlist2)
ComplexUpset::upset(
PAlist2,
colnames(PAlist2)[1:5],
base_annotations=list(
'Intersection Size'=intersection_size(mode = 'intersect' , bar_number_threshold=0.45, text_colors = c(on_background = "black", on_bar = "black"), size=0, mapping=aes(fill=Contrast), position = 'stack' #, #text_mapping = aes(colour=Contrast),
#text = list(position=position_stack())
) + ylim(0, 150) + scale_fill_manual(values=c(
"1% O2, CyA+ vs 1% O2, CyA-"='#E41A1C', "19% O2, CyA- vs 1% O2, CyA+"='#377EB8',
"1% O2, CyA- vs 19% O2, CyA-"='#4DAF4A'
)) + scale_color_manual(values=c(
"1% O2, CyA+ vs 1% O2, CyA-"='#E41A1C', "19% O2, CyA- vs 1% O2, CyA+"='#377EB8',
"1% O2, CyA- vs 19% O2, CyA-"='#4DAF4A'
))
) ,
width_ratio=0.3,
set_sizes=(upset_set_size(position='right',geom=geom_bar(stat='count', position = position_dodge(),aes(fill=Contrast)))+ scale_fill_manual(values=c(
"1% O2, CyA+ vs 1% O2, CyA-"='#E41A1C', "19% O2, CyA- vs 1% O2, CyA+"='#377EB8',
"1% O2, CyA- vs 19% O2, CyA-"='#4DAF4A'
)),
require(ComplexUpset)
PAlist2 <- lapply(PAlist, function(x){return(x[x$Method %in% c("Concatenated", "Combined", "mBONITA"), intersect(colnames(x), c('Contrast', 'Pathway',"Method", 'negativelog10FDR'))])}) #lapply(PAlist, function(x){return(x[x$Pathway %in% gmt$Pathway & x$Method %in% c("Concatenated", "Combined"), intersect(colnames(x), c('Contrast', 'Pathway',"Method", 'negativelog10FDR'))])})
PAlist2$Pathway <- unlist(lapply(PAlist2$Pathway, function(x){if(x %in% gmt$Pathway){return(paste0(x, "**"))}}))
PAlist2 <- Filter(function(x) dim(x)[1] > 0, PAlist2)
for (i in names(PAlist2)){
PAlist2[[i]]$Algorithm <- i
}
PAlist2 <- do.call(rbind,PAlist2)
rownames(PAlist2) <- 1:nrow(PAlist2)
PAlist2$Method <- 'Combined'
PAlist2 <- reshape2::acast(PAlist2, Pathway + Contrast ~ Algorithm , value.var = 'negativelog10FDR')
PAlist2[is.na(PAlist2)] <- 0
PAlist2 <- as.data.frame(apply(PAlist2, c(1,2), FUN=function(x){if(x>1.303){return(TRUE)}else{return(FALSE)}}))
PAlist2$Pathway <- gsub("\\_.*", "", rownames(PAlist2))
PAlist2$Contrast <- gsub(".*\\_", "", rownames(PAlist2))
#PAlist2 <- reshape2::melt(PAlist2)
#colnames(PAlist2) <- c("Pathway", "Algorithm", "Contrast", "negativelog10FDR")
head(PAlist2)
ComplexUpset::upset(
PAlist2,
colnames(PAlist2)[1:5],
base_annotations=list(
'Intersection Size'=intersection_size(mode = 'intersect' , bar_number_threshold=0.45, text_colors = c(on_background = "black", on_bar = "black"), size=0, mapping=aes(fill=Contrast), position = 'stack' #, #text_mapping = aes(colour=Contrast),
#text = list(position=position_stack())
) + ylim(0, 150) + scale_fill_manual(values=c(
"1% O2, CyA+ vs 1% O2, CyA-"='#E41A1C', "19% O2, CyA- vs 1% O2, CyA+"='#377EB8',
"1% O2, CyA- vs 19% O2, CyA-"='#4DAF4A'
)) + scale_color_manual(values=c(
"1% O2, CyA+ vs 1% O2, CyA-"='#E41A1C', "19% O2, CyA- vs 1% O2, CyA+"='#377EB8',
"1% O2, CyA- vs 19% O2, CyA-"='#4DAF4A'
))
) ,
width_ratio=0.3,
set_sizes=(upset_set_size(position='right',geom=geom_bar(stat='count', position = position_dodge(),aes(fill=Contrast)))+ scale_fill_manual(values=c(
"1% O2, CyA+ vs 1% O2, CyA-"='#E41A1C', "19% O2, CyA- vs 1% O2, CyA+"='#377EB8',
"1% O2, CyA- vs 19% O2, CyA-"='#4DAF4A'
))),
# moves legends over the set sizes
guides='over'
)
require(ComplexUpset)
PAlist2 <- lapply(PAlist, function(x){return(x[x$Method %in% c("Concatenated", "Combined", "mBONITA"), intersect(colnames(x), c('Contrast', 'Pathway',"Method", 'negativelog10FDR'))])}) #lapply(PAlist, function(x){return(x[x$Pathway %in% gmt$Pathway & x$Method %in% c("Concatenated", "Combined"), intersect(colnames(x), c('Contrast', 'Pathway',"Method", 'negativelog10FDR'))])})
PAlist2$Pathway <- unlist(lapply(PAlist2$Pathway, function(x){if(x %in% gmt$Pathway){return(paste0(x, "**"))}}))
PAlist2 <- Filter(function(x) dim(x)[1] > 0, PAlist2)
for (i in names(PAlist2)){
PAlist2[[i]]$Algorithm <- i
}
PAlist2 <- do.call(rbind,PAlist2)
rownames(PAlist2) <- 1:nrow(PAlist2)
PAlist2$Method <- 'Combined'
PAlist2 <- reshape2::acast(PAlist2, Pathway + Contrast ~ Algorithm , value.var = 'negativelog10FDR')
PAlist2[is.na(PAlist2)] <- 0
PAlist2 <- as.data.frame(apply(PAlist2, c(1,2), FUN=function(x){if(x>1.303){return(TRUE)}else{return(FALSE)}}))
PAlist2$Pathway <- gsub("\\_.*", "", rownames(PAlist2))
PAlist2$Contrast <- gsub(".*\\_", "", rownames(PAlist2))
#PAlist2 <- reshape2::melt(PAlist2)
#colnames(PAlist2) <- c("Pathway", "Algorithm", "Contrast", "negativelog10FDR")
head(PAlist2)
ComplexUpset::upset(
PAlist2,
colnames(PAlist2)[1:5],
base_annotations=list(
'Intersection Size'=intersection_size(mode = 'intersect' , bar_number_threshold=0.45, text_colors = c(on_background = "black", on_bar = "black"), size=0, mapping=aes(fill=Contrast), position = 'stack' #, #text_mapping = aes(colour=Contrast),
#text = list(position=position_stack())
) + ylim(0, 150) + scale_fill_manual(values=c(
"1% O2, CyA+ vs 1% O2, CyA-"='#E41A1C', "19% O2, CyA- vs 1% O2, CyA+"='#377EB8',
"1% O2, CyA- vs 19% O2, CyA-"='#4DAF4A'
)) + scale_color_manual(values=c(
"1% O2, CyA+ vs 1% O2, CyA-"='#E41A1C', "19% O2, CyA- vs 1% O2, CyA+"='#377EB8',
"1% O2, CyA- vs 19% O2, CyA-"='#4DAF4A'
))
) ,
width_ratio=0.3,
set_sizes=(upset_set_size(position='right',geom=geom_bar(stat='count', position = position_dodge(),aes(fill=Contrast)))+ scale_fill_manual(values=c(
"1% O2, CyA+ vs 1% O2, CyA-"='#E41A1C', "19% O2, CyA- vs 1% O2, CyA+"='#377EB8',
"1% O2, CyA- vs 19% O2, CyA-"='#4DAF4A'
), guide='none')),
# moves legends over the set sizes
guides='over'
)
require(ComplexUpset)
PAlist2 <- lapply(PAlist, function(x){return(x[x$Method %in% c("Concatenated", "Combined", "mBONITA"), intersect(colnames(x), c('Contrast', 'Pathway',"Method", 'negativelog10FDR'))])}) #lapply(PAlist, function(x){return(x[x$Pathway %in% gmt$Pathway & x$Method %in% c("Concatenated", "Combined"), intersect(colnames(x), c('Contrast', 'Pathway',"Method", 'negativelog10FDR'))])})
PAlist2$Pathway <- unlist(lapply(PAlist2$Pathway, function(x){if(x %in% gmt$Pathway){return(paste0(x, "**"))}}))
PAlist2 <- Filter(function(x) dim(x)[1] > 0, PAlist2)
for (i in names(PAlist2)){
PAlist2[[i]]$Algorithm <- i
}
PAlist2 <- do.call(rbind,PAlist2)
rownames(PAlist2) <- 1:nrow(PAlist2)
PAlist2$Method <- 'Combined'
PAlist2 <- reshape2::acast(PAlist2, Pathway + Contrast ~ Algorithm , value.var = 'negativelog10FDR')
PAlist2[is.na(PAlist2)] <- 0
PAlist2 <- as.data.frame(apply(PAlist2, c(1,2), FUN=function(x){if(x>1.303){return(TRUE)}else{return(FALSE)}}))
PAlist2$Pathway <- gsub("\\_.*", "", rownames(PAlist2))
PAlist2$Contrast <- gsub(".*\\_", "", rownames(PAlist2))
#PAlist2 <- reshape2::melt(PAlist2)
#colnames(PAlist2) <- c("Pathway", "Algorithm", "Contrast", "negativelog10FDR")
head(PAlist2)
ComplexUpset::upset(
PAlist2,
colnames(PAlist2)[1:5],
base_annotations=list(
'Intersection Size'=intersection_size(mode = 'intersect' , bar_number_threshold=0.45, text_colors = c(on_background = "black", on_bar = "black"), size=0, mapping=aes(fill=Contrast), position = 'stack' #, #text_mapping = aes(colour=Contrast),
#text = list(position=position_stack())
) + ylim(0, 150) + scale_fill_manual(values=c(
"1% O2, CyA+ vs 1% O2, CyA-"='#E41A1C', "19% O2, CyA- vs 1% O2, CyA+"='#377EB8',
"1% O2, CyA- vs 19% O2, CyA-"='#4DAF4A'
)) + scale_color_manual(values=c(
"1% O2, CyA+ vs 1% O2, CyA-"='#E41A1C', "19% O2, CyA- vs 1% O2, CyA+"='#377EB8',
"1% O2, CyA- vs 19% O2, CyA-"='#4DAF4A'
))
) ,
width_ratio=0.3,
set_sizes=(),
require(ComplexUpset)
PAlist2 <- lapply(PAlist, function(x){return(x[x$Method %in% c("Concatenated", "Combined", "mBONITA"), intersect(colnames(x), c('Contrast', 'Pathway',"Method", 'negativelog10FDR'))])}) #lapply(PAlist, function(x){return(x[x$Pathway %in% gmt$Pathway & x$Method %in% c("Concatenated", "Combined"), intersect(colnames(x), c('Contrast', 'Pathway',"Method", 'negativelog10FDR'))])})
PAlist2$Pathway <- unlist(lapply(PAlist2$Pathway, function(x){if(x %in% gmt$Pathway){return(paste0(x, "**"))}}))
PAlist2 <- Filter(function(x) dim(x)[1] > 0, PAlist2)
for (i in names(PAlist2)){
PAlist2[[i]]$Algorithm <- i
}
PAlist2 <- do.call(rbind,PAlist2)
rownames(PAlist2) <- 1:nrow(PAlist2)
PAlist2$Method <- 'Combined'
PAlist2 <- reshape2::acast(PAlist2, Pathway + Contrast ~ Algorithm , value.var = 'negativelog10FDR')
PAlist2[is.na(PAlist2)] <- 0
PAlist2 <- as.data.frame(apply(PAlist2, c(1,2), FUN=function(x){if(x>1.303){return(TRUE)}else{return(FALSE)}}))
PAlist2$Pathway <- gsub("\\_.*", "", rownames(PAlist2))
PAlist2$Contrast <- gsub(".*\\_", "", rownames(PAlist2))
#PAlist2 <- reshape2::melt(PAlist2)
#colnames(PAlist2) <- c("Pathway", "Algorithm", "Contrast", "negativelog10FDR")
head(PAlist2)
ComplexUpset::upset(
PAlist2,
colnames(PAlist2)[1:5],
base_annotations=list(
'Intersection Size'=intersection_size(mode = 'intersect' , bar_number_threshold=0.45, text_colors = c(on_background = "black", on_bar = "black"), size=0, mapping=aes(fill=Contrast), position = 'stack' #, #text_mapping = aes(colour=Contrast),
#text = list(position=position_stack())
) + ylim(0, 150) + scale_fill_manual(values=c(
"1% O2, CyA+ vs 1% O2, CyA-"='#E41A1C', "19% O2, CyA- vs 1% O2, CyA+"='#377EB8',
"1% O2, CyA- vs 19% O2, CyA-"='#4DAF4A'
)) + scale_color_manual(values=c(
"1% O2, CyA+ vs 1% O2, CyA-"='#E41A1C', "19% O2, CyA- vs 1% O2, CyA+"='#377EB8',
"1% O2, CyA- vs 19% O2, CyA-"='#4DAF4A'
))
) ,
width_ratio=0.3,
set_sizes=FALSE,
# moves legends over the set sizes
guides='over'
)
require(ComplexUpset)
PAlist2 <-
lapply(PAlist, function(x) {
return(x[x$Method %in% c("Concatenated", "Combined", "mBONITA"), intersect(colnames(x),
c('Contrast', 'Pathway', "Method", 'negativelog10FDR'))])
}) #lapply(PAlist, function(x){return(x[x$Pathway %in% gmt$Pathway & x$Method %in% c("Concatenated", "Combined"), intersect(colnames(x), c('Contrast', 'Pathway',"Method", 'negativelog10FDR'))])})
PAlist2$Pathway <-
unlist(lapply(PAlist2$Pathway, function(x) {
if (x %in% gmt$Pathway) {
return(paste0(x, "**"))
}
}))
PAlist2 <- Filter(function(x)
dim(x)[1] > 0, PAlist2)
for (i in names(PAlist2)) {
PAlist2[[i]]$Algorithm <- i
}
PAlist2 <- do.call(rbind, PAlist2)
rownames(PAlist2) <- 1:nrow(PAlist2)
PAlist2$Method <- 'Combined'
PAlist2 <-
reshape2::acast(PAlist2, Pathway + Contrast ~ Algorithm , value.var = 'negativelog10FDR')
PAlist2[is.na(PAlist2)] <- 0
PAlist2 <-
as.data.frame(apply(
PAlist2,
c(1, 2),
FUN = function(x) {
if (x > 1.303) {
return(TRUE)
} else{
return(FALSE)
}
))
PAlist2$Pathway <- gsub("\\_.*", "", rownames(PAlist2))
PAlist2$Contrast <- gsub(".*\\_", "", rownames(PAlist2))
#PAlist2 <- reshape2::melt(PAlist2)
#colnames(PAlist2) <- c("Pathway", "Algorithm", "Contrast", "negativelog10FDR")
head(PAlist2)
ComplexUpset::upset(
PAlist2,
colnames(PAlist2)[1:5],
base_annotations = list(
'Intersection Size' = intersection_size(
mode = 'intersect' ,
bar_number_threshold = 0.45,
text_colors = c(on_background = "black", on_bar = "black"),
size = 0,
mapping = aes(fill = Contrast),
position = 'stack' #, #text_mapping = aes(colour=Contrast),
#text = list(position=position_stack())
) + ylim(0, 150) + scale_fill_manual(
values = c(
"1% O2, CyA+ vs 1% O2, CyA-" = '#E41A1C',
"19% O2, CyA- vs 1% O2, CyA+" = '#377EB8',
"1% O2, CyA- vs 19% O2, CyA-" = '#4DAF4A'
)
) ,
width_ratio = 0.3,
set_sizes = FALSE,
# moves legends over the set sizes
#guides = 'over'
)
require(ComplexUpset)
PAlist2 <-
lapply(PAlist, function(x) {
return(x[x$Method %in% c("Concatenated", "Combined", "mBONITA"), intersect(colnames(x),
c('Contrast', 'Pathway', "Method", 'negativelog10FDR'))])
}) #lapply(PAlist, function(x){return(x[x$Pathway %in% gmt$Pathway & x$Method %in% c("Concatenated", "Combined"), intersect(colnames(x), c('Contrast', 'Pathway',"Method", 'negativelog10FDR'))])})
PAlist2$Pathway <-
unlist(lapply(PAlist2$Pathway, function(x) {
if (x %in% gmt$Pathway) {
return(paste0(x, "**"))
}
}))
PAlist2 <- Filter(function(x)
dim(x)[1] > 0, PAlist2)
for (i in names(PAlist2)) {
PAlist2[[i]]$Algorithm <- i
}
PAlist2 <- do.call(rbind, PAlist2)
rownames(PAlist2) <- 1:nrow(PAlist2)
PAlist2$Method <- 'Combined'
PAlist2 <-
reshape2::acast(PAlist2, Pathway + Contrast ~ Algorithm , value.var = 'negativelog10FDR')
PAlist2[is.na(PAlist2)] <- 0
PAlist2 <-
as.data.frame(apply(
PAlist2,
c(1, 2),
FUN = function(x) {
if (x > 1.303) {
return(TRUE)
} else{
return(FALSE)
}
))
PAlist2$Pathway <- gsub("\\_.*", "", rownames(PAlist2))
PAlist2$Contrast <- gsub(".*\\_", "", rownames(PAlist2))
#PAlist2 <- reshape2::melt(PAlist2)
#colnames(PAlist2) <- c("Pathway", "Algorithm", "Contrast", "negativelog10FDR")
head(PAlist2)
ComplexUpset::upset(
PAlist2,
colnames(PAlist2)[1:5],
base_annotations = list(
'Intersection Size' = intersection_size(
mode = 'intersect' ,
bar_number_threshold = 0.45,
text_colors = c(on_background = "black", on_bar = "black"),
size = 0,
mapping = aes(fill = Contrast),
position = 'stack' #, #text_mapping = aes(colour=Contrast),
#text = list(position=position_stack())
) + ylim(0, 150) + scale_fill_manual(
values = c(
"1% O2, CyA+ vs 1% O2, CyA-" = '#E41A1C',
"19% O2, CyA- vs 1% O2, CyA+" = '#377EB8',
"1% O2, CyA- vs 19% O2, CyA-" = '#4DAF4A'
)
) ,
width_ratio = 0.3,
set_sizes = FALSE,
# moves legends over the set sizes
guide = 'over'
)
require(UpSetR)
require(ggplot2)
require(ggsci)
require(ggpubr)
require(reshape2)
require(metap)
reshapePvals <- function(mBonita_PA) {
allPA <-
reshape2::melt(
mBonita_PA,
id.vars = c("Pathway", "Method"),
measure.vars =  c(
"X1O2PlusCyA - X1O2NoCyA",
"X1O2NoCyA - X19O2NoCyA",
"X19O2NoCyA - X1O2PlusCyA"
)
colnames(allPA) <-
c("Pathway", "Method", "Contrast", "negativelog10pvalue")
allPA$pvalue <- 10 ^ (-1 * allPA$negativelog10pvalue)
allPA$FDR <- p.adjust(allPA$pvalue, method = "BH")
allPA$negativelog10FDR <- (-1)*log10(allPA$FDR)
temp <- allPA$pvalue < 0.05
allPA <- allPA[temp,]
return(allPA)
}
#concat_PA <- read.csv("pvalues_concatenated_20220816.csv", row.names = 1, col.names= c("Pathway", "Code", "Nodes", "X1O2PlusCyA - X1O2NoCyA", "X1O2NoCyA - X19O2NoCyA", "X19O2NoCyA - X1O2PlusCyA"), check.names = FALSE)
#concat_PA$Method <- "Concatenated"
#concat_PA <- reshapePvals(concat_PA)
prot_PA <- read.csv("pvalues_proteomics_20220816.csv", row.names = 1, col.names= c("Pathway", "Code", "Nodes", "X1O2PlusCyA - X1O2NoCyA", "X1O2NoCyA - X19O2NoCyA", "X19O2NoCyA - X1O2PlusCyA"), check.names = FALSE)
prot_PA$Method <- "Proteomics"
prot_PA <- reshapePvals(prot_PA)
trans_PA <- read.csv("pvalues_transcriptomics_20221007.csv", row.names = 1, col.names= c("Pathway", "Code", "Nodes", "X1O2PlusCyA - X1O2NoCyA", "X1O2NoCyA - X19O2NoCyA", "X19O2NoCyA - X1O2PlusCyA"), check.names = FALSE) #read.csv("pvalues_transcriptomics_20220816.csv", row.names = 1, col.names= c("Pathway", "Code", "Nodes", "X1O2PlusCyA - X1O2NoCyA", "X1O2NoCyA - X19O2NoCyA", "X19O2NoCyA - X1O2PlusCyA"), check.names = FALSE)
trans_PA$Method <- "Transcriptomics"
trans_PA <- reshapePvals(trans_PA)
phosph_PA <- read.csv("pvalues_phosphoproteomics_20220816.csv", row.names = 1, col.names= c("Pathway", "Code", "Nodes", "X1O2PlusCyA - X1O2NoCyA", "X1O2NoCyA - X19O2NoCyA", "X19O2NoCyA - X1O2PlusCyA"), check.names = FALSE)
phosph_PA$Method <- "Phosphoproteomics"
phosph_PA <- reshapePvals(phosph_PA)
Bonita_PA <- rbind(prot_PA, trans_PA, phosph_PA)
temp <- as.data.frame(reshape2::acast(data = Bonita_PA, Contrast ~ Pathway , value.var = 'FDR', fun.aggregate = function(x){return(metap::sumz(x)$p)}))
temp <- as.data.frame(reshape2::melt(as.matrix(temp)))
temp$Method <- "Combined"
colnames(temp) <- c("Contrast", "Pathway", "FDR", "Method")
temp$negativelog10FDR <- (-1)*log10(temp$FDR)
hist(temp$FDR)
concat_PA <- temp
Bonita_PA <- na.omit(rbind(prot_PA[,colnames(temp)], trans_PA[,colnames(temp)], phosph_PA[,colnames(temp)], temp))
write.csv(Bonita_PA, "Bonita_allResults_20221007.csv")
temp <- Bonita_PA$FDR < 0.05
Bonita_PA <- Bonita_PA[temp,]
head(Bonita_PA)
ggplot(trans_PA) + geom_point(aes(x=negativelog10FDR, y=Pathway, color=Contrast)) + facet_wrap(facets = 'Method', drop=TRUE) + theme_bw()
ggsave(filename = "Bonita_trans_allResults.svg", width = 12, height = 24, units = 'in')
ggsave(filename = 'Bonita_trans_allResults.png', width = 12, height =24, units = 'in')
ggplot(prot_PA) + geom_point(aes(x=negativelog10FDR, y=Pathway, color=Contrast)) + facet_wrap(facets = 'Method', drop=TRUE) + theme_bw()
ggsave(filename = "Bonita_prot_allResults.svg", width = 12, height = 24, units = 'in')
ggsave(filename = 'Bonita_prot_allResults.png', width = 12, height =24, units = 'in')
ggplot(phosph_PA) + geom_point(aes(x=negativelog10FDR, y=Pathway, color=Contrast)) + facet_wrap(facets = 'Method', drop=TRUE) + theme_bw()
ggsave(filename = "Bonita_phosph_allResults.svg", width = 12, height = 24, units = 'in')
ggsave(filename = 'Bonita_phosph_allResults.png', width = 12, height =24, units = 'in')
ggplot(concat_PA) + geom_point(aes(x=negativelog10FDR, y=Pathway, color=Contrast)) + facet_wrap(facets = 'Method', drop=TRUE) + theme_bw()
ggsave(filename = "Bonita_combined_pvals_allResults.svg", width = 12, height = 24, units = 'in')
ggsave(filename = 'Bonita_combined_pvals_allResults.png', width = 12, height =24, units = 'in')
