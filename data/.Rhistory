?geom_histogram
??ggpairs
?acast
require(reshape2)
head(localData)
temp = dcast(localData, methodName + nodeList ~ ruleLengths + indegree)
head(temp)
?melt
temp = dcast(localData, ruleLengths + indegree ~ methodName + nodeList)
temp = dcast(localData, value.var = c('indegree', 'ruleLengths'), id.var = c('nodeList', 'methodName'))
temp = melt(localData, value.var = c('indegree', 'ruleLengths'), id.var = c('nodeList', 'methodName'))
head(temp)
temp = melt(localData, value.vars = c('indegree', 'ruleLengths'), id.vars = c('nodeList', 'methodName'))
head(temp)
?reshape
View(temp)
localData = read.csv('local1Data.csv')
localData = localData[,2:ncol(localData)]
head(localData)
colnames(localData)
getIndegree = function(x){
return(stringr::str_count(pattern = "\\[",string = x) - 1)
}
localData$indegree = unlist(lapply(as.vector(localData$equivs), getIndegree))
require(ggplot2)
require(GGally)
require(reshape2)
ggpairs(data = localData[localData$indegree>=3,], columns = 'ruleLengths', aes(color = methodName, shape = methodName)) + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 16)) + scale_color_brewer(palette = 'Dark2') + scale_fill_brewer(palette = 'Dark2')
ggpairs(data = localData[localData$indegree>=3,], columns = 'ruleLengths', aes(color = methodName, shape = methodName), showStrips = FALSE) + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 16)) + scale_color_brewer(palette = 'Dark2') + scale_fill_brewer(palette = 'Dark2')
ggplot(data = localData[localData$indegree>=3,]) + geom_density(aes(ruleLengths)) + facet_wrap(vars(methodName))
ggplot(data = localData[localData$indegree>=3,]) + geom_hist(aes(ruleLengths)) + facet_wrap(vars(methodName))
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths)) + facet_wrap(vars(methodName))
?geom_histogram
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths)) + facet_wrap(vars(methodName), scales = "free") + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 16)) + scale_color_brewer(palette = 'Dark2') + scale_fill_brewer(palette = 'Dark2') + xlab("Count")
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths), bins=10) + facet_wrap(vars(methodName), scales = "free") + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 16)) + scale_color_brewer(palette = 'Dark2') + scale_fill_brewer(palette = 'Dark2') + xlab("Count")
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths), bins=10) + facet_wrap(vars(methodName), scales = "free") + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 16)) + scale_color_brewer(palette = 'Dark2') + scale_fill_brewer(palette = 'Dark2') + xlab("Count") + scale_x_continuous(name = "Size of ERS", breaks = c(1,7,15,63,127))
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths), bins=5) + facet_wrap(vars(methodName), scales = "free") + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 16)) + scale_color_brewer(palette = 'Dark2') + scale_fill_brewer(palette = 'Dark2') + xlab("Count") + scale_x_continuous(name = "Size of ERS", breaks = c(1,7,15,63,127))
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths), bins=5) + facet_wrap(vars(methodName), scales = "free") + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 16)) + scale_color_brewer(palette = 'Dark2') + scale_fill_brewer(palette = 'Dark2') + xlab("Count") + scale_x_continuous(name = "Size of ERS", breaks = c(1,15,63,127))
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths), bins=5) + facet_wrap(vars(methodName), scales = "free") + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 16)) + scale_color_brewer(palette = 'Dark2') + scale_fill_brewer(palette = 'Dark2') + xlab("Count") + scale_x_continuous(name = "Size of ERS")
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths), bins=5) + facet_wrap(vars(methodName), scales = "free") + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 16)) + scale_color_brewer(palette = 'Dark2') + scale_fill_brewer(palette = 'Dark2') + xlab("Count") + scale_x_continuous(name = "Size of ERS", breaks = c(1,63,127))
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths), bins=3) + facet_wrap(vars(methodName), scales = "free") + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 16)) + scale_color_brewer(palette = 'Dark2') + scale_fill_brewer(palette = 'Dark2') + xlab("Count") + scale_x_continuous(name = "Size of ERS", breaks = c(1,63,127))
unique(localData$ruleLengths)
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths), bins=3) + facet_wrap(vars(methodName), scales = "free") + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 16)) + scale_color_brewer(palette = 'Dark2') + scale_fill_brewer(palette = 'Dark2') + ylab("Count") + scale_x_continuous(name = "Size of ERS") + xlim(1,127)
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths)) + facet_wrap(vars(methodName), scales = "free") + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 16)) + scale_color_brewer(palette = 'Dark2') + scale_fill_brewer(palette = 'Dark2') + ylab("Count") + scale_x_continuous(name = "Size of ERS") + xlim(1,127)
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths)) + facet_wrap(vars(methodName), scales = "free") + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 16)) + scale_color_brewer(palette = 'Dark2') + scale_fill_brewer(palette = 'Dark2') + ylab("Count") + scale_x_continuous(name = "Size of ERS") +                                     # Draw histogram
geom_vline(xintercept = median(ruleLengths),      # Add line for median
col = "red",
lwd = 3) +
annotate("text",                        # Add text for median
x = median(ruleLengths) * 1.7,
y = median(ruleLengths) * 1.7,
label = paste("Median =", median(ruleLengths)),
col = "red",
size = 8)
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths)) + facet_wrap(vars(methodName), scales = "free") + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 16)) + scale_color_brewer(palette = 'Dark2') + scale_fill_brewer(palette = 'Dark2') + ylab("Count") + scale_x_continuous(name = "Size of ERS")
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths)) + facet_wrap(vars(methodName), scales = "free") + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 16)) + scale_color_brewer(palette = 'Dark2') + scale_fill_brewer(palette = 'Dark2') + ylab("Count") + scale_x_continuous(name = "Size of ERS") + geom_vline(aes(xintercept=mean(ruleLengths)),
color="blue", linetype="dashed", size=1)
library(plyr)
mu <- ddply(localData[localData$indegree>=3,], "ruleLengths", summarise, grp.mean=mean(weight))
library(plyr)
mu <- ddply(localData[localData$indegree>=3,], "ruleLengths", summarise, grp.mean=mean(ruleLengths))
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths)) + facet_wrap(vars(methodName), scales = "free") + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 16)) + scale_color_brewer(palette = 'Dark2') + scale_fill_brewer(palette = 'Dark2') + ylab("Count") + scale_x_continuous(name = "Size of ERS") + geom_vline(data = mu, aes(xintercept=mean(grp.mean)),
color="blue", linetype="dashed", size=1)
grp.mean
mu
library(plyr)
mu <- ddply(localData[localData$indegree>=3,], "methodName", summarise, grp.mean=mean(ruleLengths))
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths)) + facet_wrap(vars(methodName), scales = "free") + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 16)) + scale_color_brewer(palette = 'Dark2') + scale_fill_brewer(palette = 'Dark2') + ylab("Count") + scale_x_continuous(name = "Size of ERS") + geom_vline(data = mu, aes(xintercept=mean(grp.mean)),
color="blue", linetype="dashed", size=1)
mu
library(plyr)
mu <- ddply(localData[localData$indegree>=3,], "methodName", summarise, grp.mean=mean(ruleLengths))
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths)) + facet_wrap(vars(methodName), scales = "free") + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 16)) + scale_color_brewer(palette = 'Dark2') + scale_fill_brewer(palette = 'Dark2') + ylab("Count") + scale_x_continuous(name = "Size of ERS") + geom_vline(data = mu, aes(xintercept=mean(grp.mean), color = methodName),
color="blue", linetype="dashed", size=1)
library(plyr)
mu <- ddply(localData[localData$indegree>=3,], "methodName", summarise, grp.mean=mean(ruleLengths))
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths)) + facet_wrap(vars(methodName), scales = "free") + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 16)) + scale_color_brewer(palette = 'Dark2') + scale_fill_brewer(palette = 'Dark2') + ylab("Count") + scale_x_continuous(name = "Size of ERS") + geom_vline(data = mu, aes(xintercept=mean(grp.mean), color = methodName),linetype="dashed", size=1)
library(plyr)
mu <- ddply(localData[localData$indegree>=3,], "methodName", summarise, grp.mean=mean(ruleLengths))
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths)) + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 16)) + scale_color_brewer(palette = 'Dark2') + scale_fill_brewer(palette = 'Dark2') + ylab("Count") + scale_x_continuous(name = "Size of ERS") + geom_vline(data = mu, aes(xintercept=mean(grp.mean), color = methodName),linetype="dashed", size=1)+ facet_wrap(vars(methodName), scales = "free")
mu
mean(mu$grp.mean)
ggplot(data = localData[localData$indegree>=3,]) + geom_boxplot(aes(ruleLengths))
ggplot(data = localData[localData$indegree>=3,]) + geom_boxplot(aes(x = ruleLengths, y = methodName))
ggplot(data = localData[localData$indegree>=3,]) + geom_violin(aes(x = ruleLengths, y = methodName))
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths))
ggplot(data = localData[localData$indegree>=3,]) + geom_boxplot(aes(ruleLengths))
ggplot(data = localData[localData$indegree>=3,]) + geom_boxplot(aes(x=ruleLengths,y=methodName))
mu <- ddply(localData[localData$indegree>=3,], "methodName", summarise, grp.mean=mean(ruleLengths))
mu
?aggregate
aggregate(localData$ruleLengths, by = localData$methodName, FUN=mean)
aggregate(localData$ruleLengths, by = list( localData$methodName), FUN=mean)
aggregate(localData[localData$indegree>=3,'ruleLengths'], by = list( localData[localData$indegree>=3,'methodName']), FUN=mean)
library(plyr)
mu <- ddply(localData[localData$indegree>=3,], "methodName", summarise, grp.mean=mean(ruleLengths))
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths), bins = 127) + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 16)) + scale_color_brewer(palette = 'Dark2') + scale_fill_brewer(palette = 'Dark2') + ylab("Count") + scale_x_continuous(name = "Size of ERS") + geom_vline(data = mu, aes(xintercept=mean(grp.mean), color = methodName),linetype="dashed", size=1)+ facet_wrap(vars(methodName), scales = "free")
dataLine <- iris %>%
group_by(Species) %>%
summarize(mean_x = mean(Sepal.Length))
require(tidyverse)
data("iris")
dataLine <- iris %>%
group_by(Species) %>%
summarize(mean_x = mean(Sepal.Length))
require(tidyverse)
dataLine <- iris %>%
group_by(Species) %>%
summarize(mean_x = mean(Sepal.Length))
mu
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths), bins = 127) + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 16)) + scale_color_brewer(palette = 'Dark2') + scale_fill_brewer(palette = 'Dark2') + ylab("Count") + scale_x_continuous(name = "Size of ERS") + facet_wrap(vars(methodName), scales = "free") + geom_vline(data=filter(localData[localData$indegree>=3,], methodName=="concatenated"), aes(xintercept=mu$grp.mean[mu$methodName == 'concatenated']))
filter(localData[localData$indegree>=3,], methodName="concatenated")
filter(localData[localData$indegree>=3,], methodName=="concatenated")
filter(localData[localData$indegree>=3,], 'methodName'=="concatenated")
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths), bins = 127) + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 16)) + scale_color_brewer(palette = 'Dark2') + scale_fill_brewer(palette = 'Dark2') + ylab("Count") + scale_x_continuous(name = "Size of ERS") + facet_wrap(vars(methodName), scales = "free") + geom_vline(data=filter(localData[localData$indegree>=3,], 'methodName'=="concatenated"), aes(xintercept=mu$grp.mean[mu$methodName == 'concatenated']))
filter(localData[localData$indegree>=3,], 'methodName'=="concatenated")
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths), bins = 127) + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 16)) + scale_color_brewer(palette = 'Dark2') + scale_fill_brewer(palette = 'Dark2') + ylab("Count") + scale_x_continuous(name = "Size of ERS") + facet_wrap(vars(methodName), scales = "free")
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths), bins = 5) + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 16)) + scale_color_brewer(palette = 'Dark2') + scale_fill_brewer(palette = 'Dark2') + ylab("Count") + scale_x_continuous(name = "Size of ERS") + facet_wrap(vars(methodName), scales = "free")
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths), bins = 10) + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 16)) + scale_color_brewer(palette = 'Dark2') + scale_fill_brewer(palette = 'Dark2') + ylab("Count") + scale_x_continuous(name = "Size of ERS") + facet_wrap(vars(methodName), scales = "free")
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths), bins = 20) + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 16)) + scale_color_brewer(palette = 'Dark2') + scale_fill_brewer(palette = 'Dark2') + ylab("Count") + scale_x_continuous(name = "Size of ERS") + facet_wrap(vars(methodName), scales = "free")
?geom_vline
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths), bins = 20) + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 16)) + scale_color_brewer(palette = 'Dark2') + scale_fill_brewer(palette = 'Dark2') + ylab("Count") + scale_x_continuous(name = "Size of ERS") + facet_wrap(vars(methodName), scales = "free") + geom_vline(data = mu, aes(xintercept=grp.mean)) + facet_wrap(vars(methodName))
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths), bins = 20) + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 16)) + scale_color_brewer(palette = 'Dark2') + scale_fill_brewer(palette = 'Dark2') + ylab("Count") + scale_x_continuous(name = "Size of ERS") + facet_wrap(vars(methodName), scales = "free") + geom_vline(data = mu, aes(xintercept=grp.mean, color = methodName)) + facet_wrap(vars(methodName))
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths), bins = 20) + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 16)) + scale_color_brewer(palette = 'Dark2') + scale_fill_brewer(palette = 'Dark2') + ylab("Count") + scale_x_continuous(name = "Size of ERS") + facet_wrap(vars(methodName), scales = "free") + geom_vline(data = mu, aes(xintercept=grp.mean, color = methodName), legend=FALSE) + facet_wrap(vars(methodName))
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths), bins = 20) + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 16)) + scale_color_brewer(palette = 'Dark2') + scale_fill_brewer(palette = 'Dark2') + ylab("Count") + scale_x_continuous(name = "Size of ERS") + facet_wrap(vars(methodName), scales = "free") + geom_vline(data = mu, aes(xintercept=grp.mean, color = methodName), show.legend=FALSE) + facet_wrap(vars(methodName))
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths), bins = 20) + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 16)) + scale_color_brewer(palette = 'Dark2') + scale_fill_brewer(palette = 'Dark2') + ylab("Count") + scale_x_continuous(name = "Size of ERS") + facet_wrap(vars(methodName), scales = "free") + geom_vline(data = mu, aes(xintercept=grp.mean)) + facet_wrap(vars(methodName)) + geom_text(data = mu, aes(label=grp.mean))+ facet_wrap(vars(methodName))
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths), bins = 20) + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 16))  + ylab("Count") + scale_x_continuous(name = "Size of ERS") + facet_wrap(vars(methodName), scales = "free") + geom_vline(data = mu, aes(xintercept=grp.mean)) + facet_wrap(vars(methodName)) + geom_text(data = mu, aes(label=grp.mean)) + facet_wrap(vars(methodName))
+ geom_text(data = mu, aes(label=grp.mean)) + facet_wrap(vars(methodName))
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths), bins = 20) + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 16))  + ylab("Count") + scale_x_continuous(name = "Size of ERS") + facet_wrap(vars(methodName), scales = "free") + geom_vline(data = mu, aes(xintercept=grp.mean)) + facet_wrap(vars(methodName))
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths), bins = 20) + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 16))  + ylab("Count") + scale_x_continuous(name = "Size of ERS") + facet_wrap(vars(methodName), scales = "free") + geom_vline(data = mu, aes(xintercept=grp.mean)) + facet_wrap(vars(methodName)) + geom_text(data = mu, aes(label=grp.mean))
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths), bins = 20) + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 16))  + ylab("Count") + scale_x_continuous(name = "Size of ERS") + facet_wrap(vars(methodName), scales = "free") + geom_vline(data = mu, aes(xintercept=grp.mean, label=grp.mean)) + facet_wrap(vars(methodName))
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths), bins = 20) + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 16))  + ylab("Count") + scale_x_continuous(name = "Size of ERS") + facet_wrap(vars(methodName), scales = "free") + geom_vline(data = mu, aes(xintercept=grp.mean)) + geom_label(data = mu, aes(label=grp.mean))+ facet_wrap(vars(methodName), scales = "free")
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths), bins = 20) + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 16))  + ylab("Count") + scale_x_continuous(name = "Size of ERS") + facet_wrap(vars(methodName), scales = "free") + geom_vline(data = mu, aes(xintercept=grp.mean)) + geom_label(data = mu, aes(label = methodName))+ facet_wrap(vars(methodName), scales = "free")
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths), bins = 20) + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 16))  + ylab("Count") + scale_x_continuous(name = "Size of ERS") + facet_wrap(vars(methodName), scales = "free") + geom_vline(data = mu, aes(xintercept=grp.mean)) + geom_label(data = mu, aes(label = 'methodName'))+ facet_wrap(vars(methodName), scales = "free")
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths), bins = 20) + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 16))  + ylab("Count") + scale_x_continuous(name = "Size of ERS") + facet_wrap(vars(methodName), scales = "free") + geom_vline(data = mu, aes(xintercept=grp.mean)) + geom_label(data = mu, aes(label = str(methodName)))+ facet_wrap(vars(methodName), scales = "free")
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths), bins = 20) + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 16))  + ylab("Count") + scale_x_continuous(name = "Size of ERS") + facet_wrap(vars(methodName), scales = "free") + geom_vline(data = mu, aes(xintercept=grp.mean)) + geom_text(data = mu, aes(label = grp.mean))+ facet_wrap(vars(methodName), scales = "free")
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths), bins = 20) + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 16))  + ylab("Count") + scale_x_continuous(name = "Size of ERS") + facet_wrap(vars(methodName), scales = "free") + geom_vline(data = mu, aes(xintercept=grp.mean)) + facet_wrap(vars(methodName), scales = "free")
kable(mu)
knitr::kable(mu)
levels(localData$methodName)
require(plyr)
levels(localData$methodName) = c("Combined", "Phosphoproteomics", "Proteomics", "Transcriptomics")
mu <- ddply(localData[localData$indegree>=3,], "methodName", summarise, grp.mean=mean(ruleLengths))
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths), bins = 20) + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 16))  + ylab("Count") + scale_x_continuous(name = "Size of ERS") + facet_wrap(vars(methodName), nrow=1) + geom_vline(data = mu, aes(xintercept=grp.mean)) + facet_wrap(vars(methodName), nrow=1) #, scales = "free"
ggsave(filename = "ERS_size_distribution.png", height = 4, width = 8, dpi = 600)
ggsave(filename = "ERS_size_distribution.svg", height = 4, width = 8)
ggsave(filename = "ERS_size_distribution.pdf", height = 4, width = 8)
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths), bins = 20) + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 16))  + ylab("Count") + scale_x_continuous(name = "Size of ERS") + facet_wrap(vars(methodName), nrow=1) + geom_vline(data = mu, aes(xintercept=grp.mean), color='red',linetype='dashed') + facet_wrap(vars(methodName), nrow=1) #, scales = "free"
ggsave(filename = "ERS_size_distribution.png", height = 4, width = 8, dpi = 600)
ggsave(filename = "ERS_size_distribution.svg", height = 4, width = 8)
ggsave(filename = "ERS_size_distribution.pdf", height = 4, width = 8)
require(plyr)
levels(localData$methodName) = c("Combined", "Phosphoproteomics", "Proteomics", "Transcriptomics")
mu <- ddply(localData[localData$indegree>=3,], "methodName", summarise, grp.mean=mean(ruleLengths))
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths), bins = 20) + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 16))  + ylab("Count") + scale_x_continuous(name = "Size of ERS") + facet_wrap(vars(methodName), nrow=1, scales="free_y") + geom_vline(data = mu, aes(xintercept=grp.mean), color='red',linetype='dashed') + facet_wrap(vars(methodName), nrow=1, scales="free_y") #, scales = "free"
ggsave(filename = "ERS_size_distribution.png", height = 4, width = 8, dpi = 600)
ggsave(filename = "ERS_size_distribution.svg", height = 4, width = 8)
ggsave(filename = "ERS_size_distribution.pdf", height = 4, width = 8)
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths), bins = 20) + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 15))  + ylab("Count") + scale_x_continuous(name = "Size of ERS") + facet_wrap(vars(methodName), nrow=1, scales="free_y") + geom_vline(data = mu, aes(xintercept=grp.mean), color='red',linetype='dashed') + facet_wrap(vars(methodName), nrow=1, scales="free_y") #, scales = "free"
ggsave(filename = "ERS_size_distribution.png", height = 4, width = 8, dpi = 600)
ggsave(filename = "ERS_size_distribution.svg", height = 4, width = 8)
ggsave(filename = "ERS_size_distribution.pdf", height = 4, width = 8)
require(plyr)
levels(localData$methodName) = c("Combined", "Phosphoproteomics", "Proteomics", "Transcriptomics")
mu <- ddply(localData[localData$indegree>=3,], "methodName", summarise, grp.mean=mean(ruleLengths))
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths), bins = 20) + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 14))  + ylab("Count") + scale_x_continuous(name = "Size of ERS") + facet_wrap(vars(methodName), nrow=1, scales="free_y") + geom_vline(data = mu, aes(xintercept=grp.mean), color='red',linetype='dashed') + facet_wrap(vars(methodName), nrow=1, scales="free_y") #, scales = "free"
ggsave(filename = "ERS_size_distribution.png", height = 4, width = 8, dpi = 600)
ggsave(filename = "ERS_size_distribution.svg", height = 4, width = 8)
ggsave(filename = "ERS_size_distribution.pdf", height = 4, width = 8)
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths), bins = 20) + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 14))  + ylab("Count") + scale_x_continuous(name = "Size of ERS") + facet_wrap(vars(methodName), nrow=1, scales="free_y") + geom_vline(data = mu, aes(xintercept=grp.mean), color='red',linetype='dashed') + facet_wrap(vars(methodName), nrow=1, scales="free_y") + annotate("temp") #, scales = "free"
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths), bins = 20) + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 14))  + ylab("Count") + scale_x_continuous(name = "Size of ERS") + facet_wrap(vars(methodName), nrow=1, scales="free_y") + geom_vline(data = mu, aes(xintercept=grp.mean), color='red',linetype='dashed') + facet_wrap(vars(methodName), nrow=1, scales="free_y") + annotate("text", label = 'temp') #, scales = "free"
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths), bins = 20) + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 14))  + ylab("Count") + scale_x_continuous(name = "Size of ERS") + facet_wrap(vars(methodName), nrow=1, scales="free_y") + geom_vline(data = mu, aes(xintercept=grp.mean), color='red',linetype='dashed') + facet_wrap(vars(methodName), nrow=1, scales="free_y") + annotate("text", label = 'temp', x = 2:5, y = 5000) #, scales = "free"
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths), bins = 20) + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 14))  + ylab("Count") + scale_x_continuous(name = "Size of ERS") + facet_wrap(vars(methodName), nrow=1, scales="free_y") + geom_vline(data = mu, aes(xintercept=grp.mean), color='red',linetype='dashed') + facet_wrap(vars(methodName), nrow=1, scales="free_y") + annotate("text", label = 'temp', x = 2, y = 5000) #, scales = "free"
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths), bins = 20) + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 14))  + ylab("Count") + scale_x_continuous(name = "Size of ERS") + facet_wrap(vars(methodName), nrow=1, scales="free_y") + geom_vline(data = mu, aes(xintercept=grp.mean), color='red',linetype='dashed') + annotate("text", label = 'temp', x = 2, y = 5000)+ facet_wrap(vars(methodName), nrow=1, scales="free_y")  #, scales = "free"
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths), bins = 20) + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 14))  + ylab("Count") + scale_x_continuous(name = "Size of ERS") + facet_wrap(vars(methodName), nrow=1, scales="free_y") + geom_vline(data = mu, aes(xintercept=grp.mean), color='red',linetype='dashed') + geom_vline(data = mu, aes(label=grp.mean), color='red') + facet_wrap(vars(methodName), nrow=1, scales="free_y")
ggsave(filename = "ERS_size_distribution.png", height = 4, width = 8, dpi = 600)
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths), bins = 20) + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 14))  + ylab("Count") + scale_x_continuous(name = "Size of ERS") + facet_wrap(vars(methodName), nrow=1, scales="free_y") + geom_vline(data = mu, aes(xintercept=grp.mean), color='red',linetype='dashed') + geom_text(data = mu, aes(label=grp.mean), color='red') + facet_wrap(vars(methodName), nrow=1, scales="free_y")
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths), bins = 20) + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 14))  + ylab("Count") + scale_x_continuous(name = "Size of ERS") + facet_wrap(vars(methodName), nrow=1, scales="free_y") + geom_vline(data = mu, aes(xintercept=grp.mean), color='red',linetype='dashed') + geom_text(data = mu, aes(label=grp.mean)) + facet_wrap(vars(methodName), nrow=1, scales="free_y")
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths), bins = 20) + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 14))  + ylab("Count") + scale_x_continuous(name = "Size of ERS") + facet_wrap(vars(methodName), nrow=1, scales="free_y") + geom_vline(data = mu, aes(xintercept=grp.mean), color='red',linetype='dashed') + geom_text(data = mu, x=-Inf, y=-Inf, aes(label=grp.mean)) + facet_wrap(vars(methodName), nrow=1, scales="free_y")
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths), bins = 20) + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 14))  + ylab("Count") + scale_x_continuous(name = "Size of ERS") + facet_wrap(vars(methodName), nrow=1, scales="free_y") + geom_vline(data = mu, aes(xintercept=grp.mean), color='red',linetype='dashed') + geom_text(data = mu, x=Inf, y=Inf, aes(label=grp.mean)) + facet_wrap(vars(methodName), nrow=1, scales="free_y")
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths), bins = 20) + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 14))  + ylab("Count") + scale_x_continuous(name = "Size of ERS") + facet_wrap(vars(methodName), nrow=1, scales="free_y") + geom_vline(data = mu, aes(xintercept=grp.mean), color='red',linetype='dashed') + geom_text(data = mu, aes(x=grp.mean, label=grp.mean)) + facet_wrap(vars(methodName), nrow=1, scales="free_y")
require(plyr)
levels(localData$methodName) = c("Combined", "Phosphoproteomics", "Proteomics", "Transcriptomics")
mu <- ddply(localData[localData$indegree>=3,], "methodName", summarise, grp.mean=mean(ruleLengths))
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths), bins = 20) + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 14))  + ylab("Count") + scale_x_continuous(name = "Size of ERS") + facet_wrap(vars(methodName), nrow=1, scales="free_y") + geom_vline(data = mu, aes(xintercept=grp.mean), color='red',linetype='dashed') + geom_text(data = mu, y = Inf aes(x=grp.mean, label=grp.mean)) + facet_wrap(vars(methodName), nrow=1, scales="free_y")
require(plyr)
levels(localData$methodName) = c("Combined", "Phosphoproteomics", "Proteomics", "Transcriptomics")
mu <- ddply(localData[localData$indegree>=3,], "methodName", summarise, grp.mean=mean(ruleLengths))
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths), bins = 20) + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 14))  + ylab("Count") + scale_x_continuous(name = "Size of ERS") + facet_wrap(vars(methodName), nrow=1, scales="free_y") + geom_vline(data = mu, aes(xintercept=grp.mean), color='red',linetype='dashed') + geom_text(data = mu, y = Inf, aes(x=grp.mean, label=grp.mean)) + facet_wrap(vars(methodName), nrow=1, scales="free_y")
ggsave(filename = "ERS_size_distribution.png", height = 4, width = 8, dpi = 600)
ggsave(filename = "ERS_size_distribution.svg", height = 4, width = 8)
ggsave(filename = "ERS_size_distribution.pdf", height = 4, width = 8)
require(plyr)
levels(localData$methodName) = c("Combined", "Phosphoproteomics", "Proteomics", "Transcriptomics")
mu <- ddply(localData[localData$indegree>=3,], "methodName", summarise, grp.mean=mean(ruleLengths))
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths), bins = 20) + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 14))  + ylab("Count") + scale_x_continuous(name = "Size of ERS") + facet_wrap(vars(methodName), nrow=1, scales="free_y") + geom_vline(data = mu, aes(xintercept=grp.mean), color='red',linetype='dashed') + geom_text(data = mu, y = -Inf, aes(x=grp.mean, label=grp.mean)) + facet_wrap(vars(methodName), nrow=1, scales="free_y")
ggsave(filename = "ERS_size_distribution.png", height = 4, width = 8, dpi = 600)
ggsave(filename = "ERS_size_distribution.svg", height = 4, width = 8)
ggsave(filename = "ERS_size_distribution.pdf", height = 4, width = 8)
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths), bins = 20) + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 14))  + ylab("Count") + scale_x_continuous(name = "Size of ERS") + facet_wrap(vars(methodName), nrow=1, scales="free_y") + geom_vline(data = mu, aes(xintercept=grp.mean), color='red',linetype='dashed') + geom_text(data = mu, y = 1000, aes(x=grp.mean, label=grp.mean)) + facet_wrap(vars(methodName), nrow=1, scales="free_y")
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths), bins = 20) + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 14))  + ylab("Count") + scale_x_continuous(name = "Size of ERS") + facet_wrap(vars(methodName), nrow=1, scales="free_y") + geom_vline(data = mu, aes(xintercept=grp.mean), color='red',linetype='dashed') + geom_text(data = mu, y = 500, aes(x=grp.mean, label=grp.mean)) + facet_wrap(vars(methodName), nrow=1, scales="free_y")
mu
?geom_text
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths), bins = 20) + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 14))  + ylab("Count") + scale_x_continuous(name = "Size of ERS") + facet_wrap(vars(methodName), nrow=1, scales="free_y") + geom_vline(data = mu, aes(xintercept=grp.mean), color='red',linetype='dashed') + geom_text(data = mu, position = 'topright', aes(label=grp.mean)) + facet_wrap(vars(methodName), nrow=1, scales="free_y")
?position
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths), bins = 20) + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 14))  + ylab("Count") + scale_x_continuous(name = "Size of ERS") + facet_wrap(vars(methodName), nrow=1, scales="free_y") + geom_vline(data = mu, aes(xintercept=grp.mean), color='red',linetype='dashed') + geom_label(data = mu, position = 'topright', aes(label=grp.mean)) + facet_wrap(vars(methodName), nrow=1, scales="free_y")
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths), bins = 20) + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 14))  + ylab("Count") + scale_x_continuous(name = "Size of ERS") + facet_wrap(vars(methodName), nrow=1, scales="free_y") + geom_vline(data = mu, aes(xintercept=grp.mean), color='red',linetype='dashed') + geom_label(data = mu, y = Inf, aes(x = grp.mean,label=grp.mean)) + facet_wrap(vars(methodName), nrow=1, scales="free_y")
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths), bins = 20) + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 14))  + ylab("Count") + scale_x_continuous(name = "Size of ERS") + facet_wrap(vars(methodName), nrow=1, scales="free_y") + geom_vline(data = mu, aes(xintercept=grp.mean), color='red',linetype='dashed') + geom_label(data = mu, y = Inf-100, aes(x = grp.mean,label=grp.mean)) + facet_wrap(vars(methodName), nrow=1, scales="free_y")
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths), bins = 20) + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 14))  + ylab("Count") + scale_x_continuous(name = "Size of ERS") + facet_wrap(vars(methodName), nrow=1, scales="free_y") + geom_vline(data = mu, aes(xintercept=grp.mean), color='red',linetype='dashed') + geom_label(data = mu, y = Inf, x=Inf, vjust=1, hjust=1, aes(label=grp.mean)) + facet_wrap(vars(methodName), nrow=1, scales="free_y")
mu
mu$grp.mean = round(mu$grp.mean,1)
mu
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths), bins = 20) + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 14))  + ylab("Count") + scale_x_continuous(name = "Size of ERS") + facet_wrap(vars(methodName), nrow=1, scales="free_y") + geom_vline(data = mu, aes(xintercept=grp.mean), color='red',linetype='dashed') + geom_label(data = mu, y = Inf, x=Inf, vjust=1, hjust=1, aes(label=grp.mean)) + facet_wrap(vars(methodName), nrow=1, scales="free_y")
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths), bins = 20) + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 14))  + ylab("Count") + scale_x_continuous(name = "Size of ERS") + facet_wrap(vars(methodName), nrow=1, scales="free_y") + geom_vline(data = mu, aes(xintercept=grp.mean), color='red',linetype='dashed') + geom_label(data = mu, y = Inf, x=Inf, vjust=2, hjust=2, aes(label=grp.mean)) + facet_wrap(vars(methodName), nrow=1, scales="free_y")
ggsave(filename = "ERS_size_distribution.png", height = 4, width = 8, dpi = 600)
ggsave(filename = "ERS_size_distribution.svg", height = 4, width = 8)
ggsave(filename = "ERS_size_distribution.pdf", height = 4, width = 8)
require(plyr)
levels(localData$methodName) = c("Combined", "Phosphoproteomics", "Proteomics", "Transcriptomics")
mu <- ddply(localData[localData$indegree>=3,], "methodName", summarise, grp.mean=mean(ruleLengths))
mu$grp.mean = round(mu$grp.mean,1)
ggplot(data = localData[localData$indegree>=3,]) + geom_histogram(aes(ruleLengths), bins = 20) + theme_bw() + theme(panel.grid.minor = element_line(color = 'grey', size = 0.25, linetype = 2), text = element_text(size = 14))  + ylab("Count") + scale_x_continuous(name = "Size of ERS") + facet_wrap(vars(methodName), nrow=1, scales="free_y") + geom_vline(data = mu, aes(xintercept=grp.mean), color='red',linetype='dashed') + geom_label(data = mu, y = Inf, x=Inf, vjust=2, hjust=2, aes(label=grp.mean), color = 'red') + facet_wrap(vars(methodName), nrow=1, scales="free_y")
ggsave(filename = "ERS_size_distribution.png", height = 4, width = 8, dpi = 600)
ggsave(filename = "ERS_size_distribution.svg", height = 4, width = 8)
ggsave(filename = "ERS_size_distribution.pdf", height = 4, width = 8)
?FacetWrap
?facet_wrap
rm(localData)
nodeTable = read.csv("node_table.csv")
nodeTable = nodeTable[,2:ncol(nodeTable)]
print(colnames(nodeTable))
dim(nodeTable)
ggpairs(data=nodeTable)
?ggpairs
temp = reshape(nodeTable, varying = c('Display.Name', 'IS'), idvar = 'methodName')
temp = reshape(nodeTable, varying = c('Display.Name', 'IS'), idvar = 'methodName', direction = 'wide')
?dcast
temp = dcast(nodeTable, Display.Name + methodName ~ IS)
temp = dcast(nodeTable, 'Display.Name' + 'methodName' ~ 'IS')
head(temp)
head(nodeTable)
temp = dcast(nodeTable, 'Display.Name' + 'Dataset' ~ 'IS')
head(temp)
temp = dcast(nodeTable, 'Dataset' ~ 'Display.Name' , value.var = 'IS' )
head(temp)
temp = dcast(nodeTable, Dataset ~ Display.Name , value.var = 'IS' )
head(temp)
temp = dcast(nodeTable, Dataset ~ Display.Name , value.var = IS )
temp = dcast(nodeTable, Dataset ~ Display.Name , value.var = 'IS')
data<-dplyr::select(mtcars,mpg,disp,hp)
head(data)
ggpairs(data)+theme_bw()
colnames(nodeTable)[colnames(nodeTable)=='Dataset']
colnames(nodeTable)[!colnames(nodeTable)=='Dataset']
colnames(nodeTable)[!colnames(nodeTable)!='Dataset']
wd <- getwd() #"C:\\Users\\Mukta Palshikar\\Box\\multiomics integration manuscript\\data\\paintomics\\"
setwd(wd)
wd <- paste0(wd, "/")
print(wd)
proteomics = read.csv("bonita_proteomics.csv")
colnames(proteomics)[1] = "Gene"
write.table(proteomics, "paintomics_proteomics.txt", sep="\t", row.names=FALSE)
phosphoproteomics = read.csv("bonita_phosphoproteomics.csv")
colnames(phosphoproteomics)[1] = "Gene"
write.table(phosphoproteomics, "paintomics_phosphoproteomics.txt", sep="\t", row.names=FALSE)
transcriptomics = read.csv("bonita_transcriptomics.csv")
colnames(transcriptomics)[1] = "Gene"
write.table(transcriptomics, "paintomics_transcriptomics.txt", sep="\t", row.names=FALSE)
require(readxl)
explanation <- read_excel("DE_analysis_20221003.xlsx", sheet = 'Explanation') #read_excel("C:\\Users\\Mukta\ Palshikar\\Documents\\GitHub\\moBONITA\\data\\paintomics\\DE_analysis_20221003.xlsx", sheet = 'Explanation')
for (i in 1:nrow(explanation)){
#print(explanation$Name[i])
temp = read_excel("DE_analysis_20221003.xlsx", sheet = explanation$Name[i])#read_excel("C:\\Users\\Mukta\ Palshikar\\Documents\\GitHub\\moBONITA\\data\\paintomics\\DE_analysis_20221003.xlsx", sheet = explanation$Name[i])
fileName = paste0(explanation$Dataset[i], "_", explanation$Contrast[i], ".csv")
print(fileName)
write.csv(temp, fileName)
fileName = paste0("Relevant_", fileName)
temp$absLog2FC = abs(temp$logFC)
temp2 = as.data.frame(temp$Identifier[temp$absLog2FC>quantile(temp$absLog2FC)[4]])
colnames(temp2) = "Gene"
write.csv(temp2, fileName, row.names=FALSE)
}
#contrast1
contrast1 = read.csv(paste0(getwd(), "/contrast1/Paintomics_pathways_1O2NoCyA_vs_1O2PlusCyA.xls.csv"))
contrast1$Contrast = "X1O2NoCyA - X1O2PlusCyA"
#contrast2
contrast2 = read.csv(paste0(getwd(), "/contrast2/Paintomics_pathways_1O2NoCyclo_vs_19O2NoCyclo.xls.csv"))
contrast2$Contrast = "X1O2NoCyA - X19O2NoCyA"
#contrast3
contrast3 = read.csv(paste0(getwd(), "/contrast3/Paintomics_pathways_1O2PlusCyclo_vs_19O2NoCyclo.xls.csv"))
contrast3$Contrast = "X1O2PlusCyA - X19O2NoCyA"
results <- rbind(contrast1, contrast2, contrast3)
colnames(results) = c("Pathway.name", "Unique.genes", "Uniquemetabol", "Phosphoproteomics", "PhosphoproteomicsFDR_BH", "Proteomics", "ProteomicsFDR_BH", "Transcriptomics", "TranscriptomicsFDR_BH", "Combined", "CombinedFDR_BH", "Contrast")
results = results[,!colnames(results) %in% c("X","Uniquemetabol")]
results = as.data.frame(apply(results, c(1,2), function(x){if(x%in%c("-")){return(NA)}else{return(x)}}))
write.csv(results, "paintomics_allResults.csv")
results$Proteomics_FDR = p.adjust(results$Proteomics, "BH")
results$Phosphoproteomics_FDR = p.adjust(results$Phosphoproteomics, "BH")
results$Transcriptomics_FDR = p.adjust(results$Transcriptomics, "BH")
results$Combined_FDR = p.adjust(results$Combined, "BH")
head(results)
melt_results = reshape2::melt(results, id.vars = c("Pathway.name", "Contrast"), measure.vars = c("Proteomics_FDR", "Phosphoproteomics_FDR", "Transcriptomics_FDR", "Combined_FDR"))
melt_results$variable = gsub("_FDR", "", melt_results$variable)
colnames(melt_results) = c("Pathway.name", "Contrast", "Dataset", "FDR")
melt_results$negativeLog10FDR = (-1)*log10(melt_results$FDR)
head(melt_results)
require(ComplexHeatmap)
require(ggplot2)
require(ggplotify)
require(stringr)
require(UpSetR)
require(ggsci)
require(ggpubr)
require(gridExtra)
threshold <- 0.05
cwd <- getwd()
methods <- c("CAMERA", "LeapR", "PaintOmics", "ActivePathways", "mBONITA", "multiGSEA")#"BONITA",
PAlist <- vector(mode = "list", length = length(methods))
names(PAlist) <- methods
PAlist[["CAMERA"]] <- read.csv(paste0(cwd, "/reactomeGSA-camera/camera_combinedPvalues.csv"), row.names = 1)
temp <- PAlist[["CAMERA"]]$FDR < threshold #PValue < 0.01
PAlist[["CAMERA"]] <- na.omit(PAlist[["CAMERA"]][temp,])
PAlist[["LeapR"]] <- read.csv(paste0(cwd, "/leapR/leapR_allResults.csv"))
temp <- PAlist[["LeapR"]]$BH_pvalue < threshold
PAlist[["LeapR"]] <- na.omit(PAlist[["LeapR"]][temp,])
PAlist[["LeapR"]]$Pathway <- trimws(gsub("KEGG|_|\\d+$", " ", PAlist[["LeapR"]]$Pathway))
PAlist[["PaintOmics"]]<- as.data.frame(read.csv(paste0(cwd, "/paintomics/paintomics_allResults.csv"), row.names = 1))
colnames(PAlist[["PaintOmics"]])[1] <- "Pathway"
temp <- PAlist[["PaintOmics"]]$CombinedFDR_BH < threshold
PAlist[["PaintOmics"]] <- PAlist[["PaintOmics"]][temp,]
PAlist[["PaintOmics"]]$Method <- "Combined"
PAlist[["PaintOmics"]]$negativelog10FDR <- (-1)*log10(PAlist[["PaintOmics"]]$CombinedFDR_BH)
PAlist[["ActivePathways"]]<- read.csv(paste0(cwd, "/ActivePathways/activePathways_allResults.csv"), row.names = NULL)
temp <- PAlist[["ActivePathways"]]$adjusted.p.val < threshold
PAlist[["ActivePathways"]] <- PAlist[["ActivePathways"]][temp,]
#PAlist[["BONITA"]]<- read.csv(paste0(cwd, "/mBonita_pvalues/Bonita_allResults.csv"), row.names = 1)
#temp <- PAlist[["BONITA"]]$FDR < threshold
#PAlist[["BONITA"]] <- na.omit(PAlist[["BONITA"]][temp,])
#PAlist[['BONITA']] <- na.omit(PAlist[["BONITA"]][PAlist[["BONITA"]]$Method %in% c('Combined'),])
##levels(PAlist$BONITA$Contrast) <- c("X19O2NoCyA - X1O2PlusCyA", "X19O2NoCyA - X1O2NoCyA", "X1O2PlusCyA - X1O2NoCyA" )
PAlist[["mBONITA"]]<- read.csv(paste0(cwd, "/mBonita_pvalues/mBonita_pvalues.csv"), row.names = 1)
temp <- PAlist[["mBONITA"]]$BHpvals < threshold
PAlist[['mBONITA']]$Algorithm <- 'mBONITA'
PAlist[['mBONITA']]$Method <- 'Concatenated'
PAlist[["mBONITA"]] <- na.omit(PAlist[["mBONITA"]][temp,])
PAlist[["mBONITA"]]$Pathway.Code <- PAlist[["mBONITA"]]$Pathway
PAlist[["mBONITA"]]$Pathway <- PAlist[["mBONITA"]]$Pathway.Name
PAlist[["mBONITA"]]$negativelog10FDR <- PAlist[["mBONITA"]]$negativeLog10_adjpvals
PAlist[["multiGSEA"]]<- read.csv(paste0(cwd, "/multiGSEA/multiGSEA_allResults.csv"), row.names = 1)
PAlist[["multiGSEA"]]<- na.omit(PAlist[["multiGSEA"]][PAlist[["multiGSEA"]]$combined_padj < threshold,])
PAlist[["multiGSEA"]]$Method <- "Combined"
for (n in names(PAlist)){
print(n)
PAlist[[n]]$Contrast <- gsub('X1O2NoCyA - X19O2NoCyA', '1% O2, CyA- vs 19% O2, CyA-', PAlist[[n]]$Contrast)
PAlist[[n]]$Contrast <- gsub('X1O2PlusCyA - X1O2NoCyA', '1% O2, CyA+ vs 1% O2, CyA-', PAlist[[n]]$Contrast)
PAlist[[n]]$Contrast <- gsub('X19O2NoCyA - X1O2PlusCyA', '19% O2, CyA- vs 1% O2, CyA+', PAlist[[n]]$Contrast)
PAlist[[n]]$Contrast <- gsub("X19O2NoCyA - X1O2NoCyA", '1% O2, CyA- vs 19% O2, CyA-', PAlist[[n]]$Contrast)
PAlist[[n]]$Contrast <- gsub("X1O2NoCyA - X1O2PlusCyA", '1% O2, CyA+ vs 1% O2, CyA-', PAlist[[n]]$Contrast)
PAlist[[n]]$Contrast <- gsub("X1O2NoCyA vs X19O2NoCyA", '1% O2, CyA- vs 19% O2, CyA-', PAlist[[n]]$Contrast)
PAlist[[n]]$Contrast <- gsub("X1O2PlusCyA - X19O2NoCyA", '19% O2, CyA- vs 1% O2, CyA+', PAlist[[n]]$Contrast)
print(unique(PAlist[[n]]$Contrast))
}
#PAlist[[""]]<- read.csv(paste0(cwd, ""))
print(lapply(PAlist, dim))
makeVisList <- function(tempPAlist, contrast) {
visList <- tempPAlist
tempPAlist <-
lapply(tempPAlist, function(x) {
return(x[x$Contrast == contrast, ])
})
visList[["CAMERA"]] <-
unique(str_to_title(trimws(as.vector(tempPAlist[["CAMERA"]]$Pathway[tempPAlist[["CAMERA"]]$Method == "Combined"]))))
visList[["LeapR"]] <-
unique(str_to_title(as.vector(tempPAlist[["LeapR"]]$Pathway[tempPAlist[["LeapR"]]$Method == "Phosphoproteomics"]))) #NO COMBINED RESULTS YET
visList[["PaintOmics"]] <-
unique(str_to_title(trimws(as.vector(
tempPAlist[["PaintOmics"]]$Pathway
)))) #ALREADY FILTERED TO COMBINED PVALS IN PREVIOUS STEP
visList[["BONITA"]] <-
unique(str_to_title(trimws(as.vector(tempPAlist[["BONITA"]]$Pathway[tempPAlist[["BONITA"]]$Method == "Combined"]))))
visList[["mBONITA"]] <-
unique(str_to_title(trimws(as.vector(tempPAlist[["mBONITA"]]$Pathway[tempPAlist[["mBONITA"]]$Algorithm == "mBONITA"]))))
visList[["ActivePathways"]] <-
unique(str_to_title(trimws(as.vector(
tempPAlist[["ActivePathways"]]$Pathway
))))
visList[["multiGSEA"]] <- unique(str_to_title(trimws(as.vector(
tempPAlist[["multiGSEA"]]$Pathway
))))
visList <- lapply(visList, function(x){if(length(x) > 0){return(x)}else{return(NA)}})
visList <- visList[!is.na(visList)]
#print(visList)
return(visList)
}
# "1% O2, CyA- vs 19% O2, CyA-" "1% O2, CyA+ vs 1% O2, CyA-"  "19% O2, CyA- vs 1% O2, CyA+"
visList <- makeVisList(PAlist, "19% O2, CyA- vs 1% O2, CyA+")
png(filename = "upset_X19O2NoCyA - X1O2PlusCyA.png", width = 4.5, height = 3.5, pointsize = 16, res = 1200, units = 'in')
upset(fromList(visList), order.by = c("freq", "degree"), mb.ratio = c(0.45, 0.55), empty.intersections = NULL, point.size = 4, line.size = 1 , mainbar.y.label = "Intersections", sets.x.label = "Pathways", text.scale = c(1.5,1.5,1.5,1.5,2,2), number.angles = 0, main.bar.color = 'black', sets.bar.color = 'black', shade.color = 'white', matrix.color = 'black')
dev.off()
svg(filename = "upset_X19O2NoCyA - X1O2PlusCyA.svg", width = 4.5, height = 3.5, pointsize = 16)
upset(fromList(visList), order.by = c("freq", "degree"), mb.ratio = c(0.45, 0.55), empty.intersections = NULL, point.size = 4, line.size = 1 , mainbar.y.label = "Intersections", sets.x.label = "Pathways", text.scale = c(1.5,1.5,1.5,1.5,2,2), number.angles = 0, main.bar.color = 'black', sets.bar.color = 'black', shade.color = 'white', matrix.color = 'black')
dev.off()
#upset1 = upset(fromList(visList), order.by = c("freq", "degree"), mb.ratio = c(0.6,0.4), empty.intersections = NULL, point.size = 4, line.size = 1 , mainbar.y.label = "Intersections", sets.x.label = "Pathways", text.scale = c(1.5,1.5,1.5,1.5,2,1.75), number.angles = 0, main.bar.color = 'black', sets.bar.color = 'black', shade.color = 'white', matrix.color = 'black')
lt = make_comb_mat(list_to_matrix(visList))
upset1 = UpSet(lt, pt_size = unit(5, "mm"), right_annotation = upset_right_annotation(lt, add_numbers = TRUE, numbers_rot = 0,numbers_gp = gpar(cex=1)),  top_annotation = upset_top_annotation(lt, add_numbers = TRUE, numbers_rot = 0,numbers_gp = gpar(cex=1)))
upset1 = as.grob(upset1)
# "1% O2, CyA- vs 19% O2, CyA-" "1% O2, CyA+ vs 1% O2, CyA-"  "19% O2, CyA- vs 1% O2, CyA+"
visList <- makeVisList(PAlist, "1% O2, CyA- vs 19% O2, CyA-")
png(filename = "upset_X19O2NoCyA - X1O2NoCyA.png", width = 4.5, height = 3.5, pointsize = 16, res = 1200, units = 'in')
upset(fromList(visList), order.by = c("freq", "degree"), mb.ratio = c(0.55, 0.45), empty.intersections = NULL, point.size = 4, line.size = 1 , mainbar.y.label = "Intersections", sets.x.label = "Pathways", text.scale = c(1.5,1.5,1.5,1.5,1.5,1.5), number.angles = 0, main.bar.color = 'black', sets.bar.color = 'black', shade.color = 'white', matrix.color = 'black')
dev.off()
svg(filename = "upset_X19O2NoCyA - X1O2NoCyA.svg", width = 4.5, height = 3.5, pointsize = 16)
upset(fromList(visList), order.by = c("freq", "degree"), mb.ratio = c(0.55, 0.45), empty.intersections = NULL, point.size = 4, line.size = 1 , mainbar.y.label = "Intersections", sets.x.label = "Pathways", text.scale = c(1.5,1.5,1.5,1.5,1.5,1.5), number.angles = 0, main.bar.color = 'black', sets.bar.color = 'black', shade.color = 'white', matrix.color = 'black')
dev.off()
#upset2 = upset(fromList(visList), order.by = c("freq", "degree"), mb.ratio = c(0.6,0.4), empty.intersections = NULL, point.size = 4, line.size = 1 , mainbar.y.label = "Intersections", sets.x.label = "Pathways", text.scale = c(1.5,1.5,1.5,1.5,2,1.75), number.angles = 0, main.bar.color = 'black', sets.bar.color = 'black', shade.color = 'white', matrix.color = 'black')
#complexheatmap version
lt = make_comb_mat(list_to_matrix(visList))
upset2 = UpSet(lt, pt_size = unit(5, "mm"), right_annotation = upset_right_annotation(lt, add_numbers = TRUE, numbers_rot = 0,numbers_gp = gpar(cex=1)),  top_annotation = upset_top_annotation(lt, add_numbers = TRUE, numbers_rot = 0,numbers_gp = gpar(cex=1)))
upset2 = as.grob(upset2)
# "1% O2, CyA- vs 19% O2, CyA-" "1% O2, CyA+ vs 1% O2, CyA-"  "19% O2, CyA- vs 1% O2, CyA+"
visList <- makeVisList(PAlist, "1% O2, CyA+ vs 1% O2, CyA-")
png(filename = "upset_X1O2PlusCyA - X1O2NoCyA.png", width = 4.5, height = 3.5, pointsize = 16, res = 1200, units = 'in')
upset(fromList(visList), order.by = c("freq", "degree"), mb.ratio = c(0.55, 0.45), empty.intersections = NULL, point.size = 4, line.size = 1 , mainbar.y.label = "Intersections", sets.x.label = "Pathways", text.scale = c(1.5,1.5,1.5,1.5,1.5,1.5), number.angles = 0, main.bar.color = 'black', sets.bar.color = 'black', shade.color = 'white', matrix.color = 'black')
dev.off()
svg(filename = "upset_X1O2PlusCyA - X1O2NoCyA.svg", width = 4.5, height = 3.5, pointsize = 16,)
upset(fromList(visList), order.by = c("freq", "degree"), mb.ratio = c(0.55, 0.45), empty.intersections = NULL, point.size = 4, line.size = 1 , mainbar.y.label = "Intersections", sets.x.label = "Pathways", text.scale = c(1.5,1.5,1.5,1.5,1.5,1.5), number.angles = 0, main.bar.color = 'black', sets.bar.color = 'black', shade.color = 'white', matrix.color = 'black')
dev.off()
#upset3 = upset(fromList(visList), order.by = c("freq", "degree"), mb.ratio = c(0.6,0.4), empty.intersections = NULL, point.size = 4, line.size = 1 , mainbar.y.label = "Intersections", sets.x.label = "Pathways", text.scale = c(1.5,1.5,1.5,1.5,2,1.75), number.angles = 0, main.bar.color = 'black', sets.bar.color = 'black', shade.color = 'white', matrix.color = 'black')
lt = make_comb_mat(list_to_matrix(visList))
upset3 = UpSet(lt, pt_size = unit(5, "mm"), right_annotation = upset_right_annotation(lt, add_numbers = TRUE, numbers_rot = 0,numbers_gp = gpar(cex=1)),  top_annotation = upset_top_annotation(lt, add_numbers = TRUE, numbers_rot = 0,numbers_gp = gpar(cex=1)))
upset3 = as.grob(upset3)
pathways <- as.vector(read.table("PATHWAYS IN HIF1A NETWORK KEGG IDS.txt", header=FALSE, fill=TRUE)[,1])
print(pathways)
gmt <- read.table('kegg_networks_edited.gmt', header=FALSE, fill=TRUE, sep = "\t")[,1:2]
colnames(gmt) <- c('Pathway', 'KEGGID')
gmt <- na.omit(gmt[gmt$KEGGID %in% pathways, c("KEGGID", "Pathway")])
rownames(gmt) <- gmt$KEGGID
print(gmt)
PAlist2 <- lapply(PAlist, function(x){return(x[x$Method %in% c("Concatenated", "Combined", "mBONITA"), intersect(colnames(x), c('Contrast', 'Pathway',"Method", 'negativelog10FDR'))])}) #lapply(PAlist, function(x){return(x[x$Pathway %in% gmt$Pathway & x$Method %in% c("Concatenated", "Combined"), intersect(colnames(x), c('Contrast', 'Pathway',"Method", 'negativelog10FDR'))])})
PAlist2$Pathway <- unlist(lapply(PAlist2$Pathway, function(x){if(x %in% gmt$Pathway){return(paste0(x, "**"))}}))
PAlist2 <- Filter(function(x) dim(x)[1] > 0, PAlist2)
for (i in names(PAlist2)){
PAlist2[[i]]$Algorithm <- i
print(i)
print(colnames(PAlist2[[i]]))
print("###")
}
PAlist2 <- do.call(rbind,PAlist2)
rownames(PAlist2) <- 1:nrow(PAlist2)
PAlist2$Method <- 'Combined'
PAlist2
PAlist2 <- reshape2::acast(PAlist2, Pathway ~ Algorithm ~ Contrast, value.var = 'negativelog10FDR')
PAlist2[is.na(PAlist2)] <- 0
PAlist2 <- reshape2::melt(PAlist2)
colnames(PAlist2) <- c("Pathway", "Algorithm", "Contrast", "negativelog10FDR")
PAlist2
PAlist2$Significant <- as.factor(unlist(lapply(PAlist2$negativelog10FDR, function(x){if(x<1.303){return(FALSE)}else{return(TRUE)}})))
#filter out pathways that aren't significant in any method/contrast combination
#aggregate(Significant ~ Pathway, data = PAlist2, FUN = sum)
p1 <- ggplot(PAlist2, aes(Algorithm, Pathway, fill=Significant)) + geom_tile(color = 'black', size = 0.3) + facet_wrap(~Contrast) + theme_pubr() + rotate_x_text(90) + scale_fill_brewer()
#ggpar(p1, palette = "npg")
#png(filename = "heatmap_HIF1pathways.png", width = 10, height = 4, pointsize = 14, res = 600, units = 'in')
png(filename = "heatmap_allKEGGpathways.png", width = 20, height = 14, pointsize = 14, res = 600, units = 'in')
p1
dev.off()
print(p1)
svg(filename = "heatmap_allKEGGpathways.svg", width = 10, height = 14, pointsize = 14)
p1
dev.off()
print(p1)
PAlist2$Pathway <- gsub("\\*\\*", "", PAlist2$Pathway)
PAlist2 <- na.omit(PAlist2[PAlist2$Pathway %in% gmt$Pathway,])
PAlist2$Contrast <- gsub(" vs ", "\nvs ", PAlist2$Contrast)
PAlist2$Pathway <- gsub(" pathway", "", PAlist2$Pathway)
p1 <- ggplot(PAlist2, aes(Algorithm, Pathway, fill=Significant)) + geom_tile(color = 'black', size = 0.3) + facet_wrap(~Contrast) + theme_pubr() + rotate_x_text(90) + scale_fill_brewer() + theme(text = element_text(size=16))
#ggpar(p1, palette = "npg")
#png(filename = "heatmap_HIF1pathways.png", width = 10, height = 4, pointsize = 14, res = 600, units = 'in')
png(filename = "heatmap_HIF1_pathways.png", width = 10, height = 10, pointsize = 14, res = 600, units = 'in')
p1
dev.off()
print(p1)
svg(filename = "heatmap_HIF1_pathways.svg", width = 10, height = 10, pointsize = 14)
p1
dev.off()
print(p1)
hif1 = p1
PAlist2 <- as.data.frame(apply(PAlist2, 2, as.vector))
signif_in_most_methods <- unique(PAlist2$Pathway[PAlist2$Significant == TRUE & PAlist2$Algorithm %in% c("ActivePathways", "CAMERA", "mBONITA", "PaintOmics", "multiGSEA")])
PAlist2$Pathway <- gsub("\\*\\*", "", PAlist2$Pathway)
PAlist2 <- na.omit(PAlist2[PAlist2$Pathway %in% signif_in_most_methods,])
p1 <- ggplot(PAlist2, aes(Algorithm, Pathway, fill=Significant)) + geom_tile(color = 'black', size = 0.3) + facet_wrap(~Contrast) + theme_pubr() + rotate_x_text(90) + scale_fill_brewer()
#ggpar(p1, palette = "npg")
#png(filename = "heatmap_HIF1pathways.png", width = 10, height = 4, pointsize = 14, res = 600, units = 'in')
png(filename = "heatmap_signif_in_most_methods.png", width = 10, height = 10, pointsize = 14, res = 600, units = 'in')
p1
dev.off()
print(p1)
svg(filename = "heatmap_signif_in_most_methods.svg", width = 10, height = 10, pointsize = 14)
p1
dev.off()
print(p1)
upset1 = as.grob(upset1)
upset2 = as.grob(upset2)
upset3 = as.grob(upset3)
svg('Figure5_autoArranged.svg', width = 11, height = 10)
ggarrange(ggarrange(upset2,upset3,upset1,labels = c("A", "B", "C"), nrow=1, ncol = 3), hif1, labels = c("", "D"), nrow = 2, heights = c(1.25,1.5))
dev.off()
pdf('Figure5_autoArranged.pdf', width = 11, height = 10)
ggarrange(ggarrange(upset2,upset3,upset1,labels = c("A", "B", "C"), nrow=1, ncol = 3), hif1, labels = c("", "D"), nrow = 2, heights = c(1.25,1.5))
dev.off()
#p5 = arrangeGrob(upset2,upset3,upset1,hif1, layout_matrix = matrix(data = c(1,2,3,1,2,3,4,4,4,4,4,4,4,4,4), ncol=3, nrow=5, byrow=TRUE)) #note order
#ggsave('temp2.svg', p5, height = 10, width = 10, units="in")
