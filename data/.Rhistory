#PAlist2 <- reshape2::melt(PAlist2)
#colnames(PAlist2) <- c("Pathway", "Algorithm", "Contrast", "negativelog10FDR")
head(PAlist2)
ComplexUpset::upset(
PAlist2,
colnames(PAlist2)[1:5],
base_annotations=list(
'Intersection Size'=intersection_size(mode = 'intersect' , bar_number_threshold=0.45, text_colors = c(on_background = "black", on_bar = "black"), size=0, mapping=aes(fill=Contrast, label=Contrast), position = position_dodge(), text_mapping = aes(fill=Contrast),
text = list(position=position_stack())
) + ylim(0, 150) + scale_fill_manual(values=c(
"1% O2, CyA+ vs 1% O2, CyA-"='#E41A1C', "19% O2, CyA- vs 1% O2, CyA+"='#377EB8',
"1% O2, CyA- vs 19% O2, CyA-"='#4DAF4A'
))
) ,
width_ratio=0.3,
set_sizes=(upset_set_size(position='right',geom=geom_bar(stat='count', position = position_dodge(),aes(fill=Contrast)))+ scale_fill_discrete(guide='none')),
# moves legends over the set sizes
guides='over'
)
require(ComplexUpset)
PAlist2 <- lapply(PAlist, function(x){return(x[x$Method %in% c("Concatenated", "Combined", "mBONITA"), intersect(colnames(x), c('Contrast', 'Pathway',"Method", 'negativelog10FDR'))])}) #lapply(PAlist, function(x){return(x[x$Pathway %in% gmt$Pathway & x$Method %in% c("Concatenated", "Combined"), intersect(colnames(x), c('Contrast', 'Pathway',"Method", 'negativelog10FDR'))])})
PAlist2$Pathway <- unlist(lapply(PAlist2$Pathway, function(x){if(x %in% gmt$Pathway){return(paste0(x, "**"))}}))
PAlist2 <- Filter(function(x) dim(x)[1] > 0, PAlist2)
for (i in names(PAlist2)){
PAlist2[[i]]$Algorithm <- i
}
PAlist2 <- do.call(rbind,PAlist2)
rownames(PAlist2) <- 1:nrow(PAlist2)
PAlist2$Method <- 'Combined'
PAlist2 <- reshape2::acast(PAlist2, Pathway + Contrast ~ Algorithm , value.var = 'negativelog10FDR')
PAlist2[is.na(PAlist2)] <- 0
PAlist2 <- as.data.frame(apply(PAlist2, c(1,2), FUN=function(x){if(x>1.303){return(TRUE)}else{return(FALSE)}}))
PAlist2$Pathway <- gsub("\\_.*", "", rownames(PAlist2))
PAlist2$Contrast <- gsub(".*\\_", "", rownames(PAlist2))
#PAlist2 <- reshape2::melt(PAlist2)
#colnames(PAlist2) <- c("Pathway", "Algorithm", "Contrast", "negativelog10FDR")
head(PAlist2)
ComplexUpset::upset(
PAlist2,
colnames(PAlist2)[1:5],
base_annotations=list(
'Intersection Size'=intersection_size(mode = 'intersect' , bar_number_threshold=0.45, text_colors = c(on_background = "black", on_bar = "black"), size=0, mapping=aes(fill=Contrast, label=Contrast), position = position_dodge(), text_mapping = aes(hue=Contrast),
text = list(position=position_stack())
) + ylim(0, 150) + scale_fill_manual(values=c(
"1% O2, CyA+ vs 1% O2, CyA-"='#E41A1C', "19% O2, CyA- vs 1% O2, CyA+"='#377EB8',
"1% O2, CyA- vs 19% O2, CyA-"='#4DAF4A'
))
) ,
width_ratio=0.3,
set_sizes=(upset_set_size(position='right',geom=geom_bar(stat='count', position = position_dodge(),aes(fill=Contrast)))+ scale_fill_discrete(guide='none')),
# moves legends over the set sizes
guides='over'
)
require(ComplexUpset)
PAlist2 <- lapply(PAlist, function(x){return(x[x$Method %in% c("Concatenated", "Combined", "mBONITA"), intersect(colnames(x), c('Contrast', 'Pathway',"Method", 'negativelog10FDR'))])}) #lapply(PAlist, function(x){return(x[x$Pathway %in% gmt$Pathway & x$Method %in% c("Concatenated", "Combined"), intersect(colnames(x), c('Contrast', 'Pathway',"Method", 'negativelog10FDR'))])})
PAlist2$Pathway <- unlist(lapply(PAlist2$Pathway, function(x){if(x %in% gmt$Pathway){return(paste0(x, "**"))}}))
PAlist2 <- Filter(function(x) dim(x)[1] > 0, PAlist2)
for (i in names(PAlist2)){
PAlist2[[i]]$Algorithm <- i
}
PAlist2 <- do.call(rbind,PAlist2)
rownames(PAlist2) <- 1:nrow(PAlist2)
PAlist2$Method <- 'Combined'
PAlist2 <- reshape2::acast(PAlist2, Pathway + Contrast ~ Algorithm , value.var = 'negativelog10FDR')
PAlist2[is.na(PAlist2)] <- 0
PAlist2 <- as.data.frame(apply(PAlist2, c(1,2), FUN=function(x){if(x>1.303){return(TRUE)}else{return(FALSE)}}))
PAlist2$Pathway <- gsub("\\_.*", "", rownames(PAlist2))
PAlist2$Contrast <- gsub(".*\\_", "", rownames(PAlist2))
#PAlist2 <- reshape2::melt(PAlist2)
#colnames(PAlist2) <- c("Pathway", "Algorithm", "Contrast", "negativelog10FDR")
head(PAlist2)
ComplexUpset::upset(
PAlist2,
colnames(PAlist2)[1:5],
base_annotations=list(
'Intersection Size'=intersection_size(mode = 'intersect' , bar_number_threshold=0.45, text_colors = c(on_background = "black", on_bar = "black"), size=0, mapping=aes(fill=Contrast, label=Contrast), position = position_dodge(), text_mapping = aes(colour=Contrast),
text = list(position=position_stack())
) + ylim(0, 150) + scale_fill_manual(values=c(
"1% O2, CyA+ vs 1% O2, CyA-"='#E41A1C', "19% O2, CyA- vs 1% O2, CyA+"='#377EB8',
"1% O2, CyA- vs 19% O2, CyA-"='#4DAF4A'
))
) ,
width_ratio=0.3,
set_sizes=(upset_set_size(position='right',geom=geom_bar(stat='count', position = position_dodge(),aes(fill=Contrast)))+ scale_fill_discrete(guide='none')),
# moves legends over the set sizes
guides='over'
)
require(ComplexUpset)
PAlist2 <- lapply(PAlist, function(x){return(x[x$Method %in% c("Concatenated", "Combined", "mBONITA"), intersect(colnames(x), c('Contrast', 'Pathway',"Method", 'negativelog10FDR'))])}) #lapply(PAlist, function(x){return(x[x$Pathway %in% gmt$Pathway & x$Method %in% c("Concatenated", "Combined"), intersect(colnames(x), c('Contrast', 'Pathway',"Method", 'negativelog10FDR'))])})
PAlist2$Pathway <- unlist(lapply(PAlist2$Pathway, function(x){if(x %in% gmt$Pathway){return(paste0(x, "**"))}}))
PAlist2 <- Filter(function(x) dim(x)[1] > 0, PAlist2)
for (i in names(PAlist2)){
PAlist2[[i]]$Algorithm <- i
}
PAlist2 <- do.call(rbind,PAlist2)
rownames(PAlist2) <- 1:nrow(PAlist2)
PAlist2$Method <- 'Combined'
PAlist2 <- reshape2::acast(PAlist2, Pathway + Contrast ~ Algorithm , value.var = 'negativelog10FDR')
PAlist2[is.na(PAlist2)] <- 0
PAlist2 <- as.data.frame(apply(PAlist2, c(1,2), FUN=function(x){if(x>1.303){return(TRUE)}else{return(FALSE)}}))
PAlist2$Pathway <- gsub("\\_.*", "", rownames(PAlist2))
PAlist2$Contrast <- gsub(".*\\_", "", rownames(PAlist2))
#PAlist2 <- reshape2::melt(PAlist2)
#colnames(PAlist2) <- c("Pathway", "Algorithm", "Contrast", "negativelog10FDR")
head(PAlist2)
ComplexUpset::upset(
PAlist2,
colnames(PAlist2)[1:5],
base_annotations=list(
'Intersection Size'=intersection_size(mode = 'intersect' , bar_number_threshold=0.45, text_colors = c(on_background = "black", on_bar = "black"), size=0, mapping=aes(fill=Contrast, label=Contrast), position = position_dodge(), text_mapping = aes(colour=Contrast),
text = list(position=position_stack())
) + ylim(0, 150) + scale_fill_manual(values=c(
"1% O2, CyA+ vs 1% O2, CyA-"='#E41A1C', "19% O2, CyA- vs 1% O2, CyA+"='#377EB8',
"1% O2, CyA- vs 19% O2, CyA-"='#4DAF4A'
)) + scale_color_manual(values=c(
"1% O2, CyA+ vs 1% O2, CyA-"='#E41A1C', "19% O2, CyA- vs 1% O2, CyA+"='#377EB8',
"1% O2, CyA- vs 19% O2, CyA-"='#4DAF4A'
))
) ,
width_ratio=0.3,
set_sizes=(upset_set_size(position='right',geom=geom_bar(stat='count', position = position_dodge(),aes(fill=Contrast)))+ scale_fill_discrete(guide='none')),
# moves legends over the set sizes
guides='over'
)
require(ComplexUpset)
PAlist2 <- lapply(PAlist, function(x){return(x[x$Method %in% c("Concatenated", "Combined", "mBONITA"), intersect(colnames(x), c('Contrast', 'Pathway',"Method", 'negativelog10FDR'))])}) #lapply(PAlist, function(x){return(x[x$Pathway %in% gmt$Pathway & x$Method %in% c("Concatenated", "Combined"), intersect(colnames(x), c('Contrast', 'Pathway',"Method", 'negativelog10FDR'))])})
PAlist2$Pathway <- unlist(lapply(PAlist2$Pathway, function(x){if(x %in% gmt$Pathway){return(paste0(x, "**"))}}))
PAlist2 <- Filter(function(x) dim(x)[1] > 0, PAlist2)
for (i in names(PAlist2)){
PAlist2[[i]]$Algorithm <- i
}
PAlist2 <- do.call(rbind,PAlist2)
rownames(PAlist2) <- 1:nrow(PAlist2)
PAlist2$Method <- 'Combined'
PAlist2 <- reshape2::acast(PAlist2, Pathway + Contrast ~ Algorithm , value.var = 'negativelog10FDR')
PAlist2[is.na(PAlist2)] <- 0
PAlist2 <- as.data.frame(apply(PAlist2, c(1,2), FUN=function(x){if(x>1.303){return(TRUE)}else{return(FALSE)}}))
PAlist2$Pathway <- gsub("\\_.*", "", rownames(PAlist2))
PAlist2$Contrast <- gsub(".*\\_", "", rownames(PAlist2))
#PAlist2 <- reshape2::melt(PAlist2)
#colnames(PAlist2) <- c("Pathway", "Algorithm", "Contrast", "negativelog10FDR")
head(PAlist2)
ComplexUpset::upset(
PAlist2,
colnames(PAlist2)[1:5],
base_annotations=list(
'Intersection Size'=intersection_size(mode = 'intersect' , bar_number_threshold=0.45, text_colors = c(on_background = "black", on_bar = "black"), size=0, mapping=aes(fill=Contrast, label=Contrast), position = position_dodge(), text_mapping = aes(label = Contrast, colour=Contrast),
text = list(position=position_stack())
) + ylim(0, 150) + scale_fill_manual(values=c(
"1% O2, CyA+ vs 1% O2, CyA-"='#E41A1C', "19% O2, CyA- vs 1% O2, CyA+"='#377EB8',
"1% O2, CyA- vs 19% O2, CyA-"='#4DAF4A'
)) + scale_color_manual(values=c(
"1% O2, CyA+ vs 1% O2, CyA-"='#E41A1C', "19% O2, CyA- vs 1% O2, CyA+"='#377EB8',
"1% O2, CyA- vs 19% O2, CyA-"='#4DAF4A'
))
) ,
width_ratio=0.3,
set_sizes=(upset_set_size(position='right',geom=geom_bar(stat='count', position = position_dodge(),aes(fill=Contrast)))+ scale_fill_discrete(guide='none')),
# moves legends over the set sizes
guides='over'
)
require(ComplexUpset)
PAlist2 <- lapply(PAlist, function(x){return(x[x$Method %in% c("Concatenated", "Combined", "mBONITA"), intersect(colnames(x), c('Contrast', 'Pathway',"Method", 'negativelog10FDR'))])}) #lapply(PAlist, function(x){return(x[x$Pathway %in% gmt$Pathway & x$Method %in% c("Concatenated", "Combined"), intersect(colnames(x), c('Contrast', 'Pathway',"Method", 'negativelog10FDR'))])})
PAlist2$Pathway <- unlist(lapply(PAlist2$Pathway, function(x){if(x %in% gmt$Pathway){return(paste0(x, "**"))}}))
PAlist2 <- Filter(function(x) dim(x)[1] > 0, PAlist2)
for (i in names(PAlist2)){
PAlist2[[i]]$Algorithm <- i
}
PAlist2 <- do.call(rbind,PAlist2)
rownames(PAlist2) <- 1:nrow(PAlist2)
PAlist2$Method <- 'Combined'
PAlist2 <- reshape2::acast(PAlist2, Pathway + Contrast ~ Algorithm , value.var = 'negativelog10FDR')
PAlist2[is.na(PAlist2)] <- 0
PAlist2 <- as.data.frame(apply(PAlist2, c(1,2), FUN=function(x){if(x>1.303){return(TRUE)}else{return(FALSE)}}))
PAlist2$Pathway <- gsub("\\_.*", "", rownames(PAlist2))
PAlist2$Contrast <- gsub(".*\\_", "", rownames(PAlist2))
#PAlist2 <- reshape2::melt(PAlist2)
#colnames(PAlist2) <- c("Pathway", "Algorithm", "Contrast", "negativelog10FDR")
head(PAlist2)
ComplexUpset::upset(
PAlist2,
colnames(PAlist2)[1:5],
base_annotations=list(
'Intersection Size'=intersection_size(mode = 'intersect' , bar_number_threshold=0.45, text_colors = c(on_background = "black", on_bar = "black"), size=0, mapping=aes(fill=Contrast), position = 'stack' #, #text_mapping = aes(colour=Contrast),
#text = list(position=position_stack())
) + ylim(0, 150) + scale_fill_manual(values=c(
"1% O2, CyA+ vs 1% O2, CyA-"='#E41A1C', "19% O2, CyA- vs 1% O2, CyA+"='#377EB8',
"1% O2, CyA- vs 19% O2, CyA-"='#4DAF4A'
)) + scale_color_manual(values=c(
"1% O2, CyA+ vs 1% O2, CyA-"='#E41A1C', "19% O2, CyA- vs 1% O2, CyA+"='#377EB8',
"1% O2, CyA- vs 19% O2, CyA-"='#4DAF4A'
))
) ,
width_ratio=0.3,
set_sizes=(upset_set_size(position='right',geom=geom_bar(stat='count', position = position_dodge(),aes(fill=Contrast)))+ scale_fill_discrete(guide='none')),
# moves legends over the set sizes
guides='over'
)
require(ComplexUpset)
PAlist2 <- lapply(PAlist, function(x){return(x[x$Method %in% c("Concatenated", "Combined", "mBONITA"), intersect(colnames(x), c('Contrast', 'Pathway',"Method", 'negativelog10FDR'))])}) #lapply(PAlist, function(x){return(x[x$Pathway %in% gmt$Pathway & x$Method %in% c("Concatenated", "Combined"), intersect(colnames(x), c('Contrast', 'Pathway',"Method", 'negativelog10FDR'))])})
PAlist2$Pathway <- unlist(lapply(PAlist2$Pathway, function(x){if(x %in% gmt$Pathway){return(paste0(x, "**"))}}))
PAlist2 <- Filter(function(x) dim(x)[1] > 0, PAlist2)
for (i in names(PAlist2)){
PAlist2[[i]]$Algorithm <- i
}
PAlist2 <- do.call(rbind,PAlist2)
rownames(PAlist2) <- 1:nrow(PAlist2)
PAlist2$Method <- 'Combined'
PAlist2 <- reshape2::acast(PAlist2, Pathway + Contrast ~ Algorithm , value.var = 'negativelog10FDR')
PAlist2[is.na(PAlist2)] <- 0
PAlist2 <- as.data.frame(apply(PAlist2, c(1,2), FUN=function(x){if(x>1.303){return(TRUE)}else{return(FALSE)}}))
PAlist2$Pathway <- gsub("\\_.*", "", rownames(PAlist2))
PAlist2$Contrast <- gsub(".*\\_", "", rownames(PAlist2))
#PAlist2 <- reshape2::melt(PAlist2)
#colnames(PAlist2) <- c("Pathway", "Algorithm", "Contrast", "negativelog10FDR")
head(PAlist2)
ComplexUpset::upset(
PAlist2,
colnames(PAlist2)[1:5],
base_annotations=list(
'Intersection Size'=intersection_size(mode = 'intersect' , bar_number_threshold=0.45, text_colors = c(on_background = "black", on_bar = "black"), size=0, mapping=aes(fill=Contrast), position = 'stack' #, #text_mapping = aes(colour=Contrast),
#text = list(position=position_stack())
) + ylim(0, 150) + scale_fill_manual(values=c(
"1% O2, CyA+ vs 1% O2, CyA-"='#E41A1C', "19% O2, CyA- vs 1% O2, CyA+"='#377EB8',
"1% O2, CyA- vs 19% O2, CyA-"='#4DAF4A'
)) + scale_color_manual(values=c(
"1% O2, CyA+ vs 1% O2, CyA-"='#E41A1C', "19% O2, CyA- vs 1% O2, CyA+"='#377EB8',
"1% O2, CyA- vs 19% O2, CyA-"='#4DAF4A'
))
) ,
width_ratio=0.3,
set_sizes=(upset_set_size(position='right',geom=geom_bar(stat='count', position = position_dodge(),aes(fill=Contrast)))+ scale_fill_manual(values=c(
"1% O2, CyA+ vs 1% O2, CyA-"='#E41A1C', "19% O2, CyA- vs 1% O2, CyA+"='#377EB8',
"1% O2, CyA- vs 19% O2, CyA-"='#4DAF4A'
)),
require(ComplexUpset)
PAlist2 <- lapply(PAlist, function(x){return(x[x$Method %in% c("Concatenated", "Combined", "mBONITA"), intersect(colnames(x), c('Contrast', 'Pathway',"Method", 'negativelog10FDR'))])}) #lapply(PAlist, function(x){return(x[x$Pathway %in% gmt$Pathway & x$Method %in% c("Concatenated", "Combined"), intersect(colnames(x), c('Contrast', 'Pathway',"Method", 'negativelog10FDR'))])})
PAlist2$Pathway <- unlist(lapply(PAlist2$Pathway, function(x){if(x %in% gmt$Pathway){return(paste0(x, "**"))}}))
PAlist2 <- Filter(function(x) dim(x)[1] > 0, PAlist2)
for (i in names(PAlist2)){
PAlist2[[i]]$Algorithm <- i
}
PAlist2 <- do.call(rbind,PAlist2)
rownames(PAlist2) <- 1:nrow(PAlist2)
PAlist2$Method <- 'Combined'
PAlist2 <- reshape2::acast(PAlist2, Pathway + Contrast ~ Algorithm , value.var = 'negativelog10FDR')
PAlist2[is.na(PAlist2)] <- 0
PAlist2 <- as.data.frame(apply(PAlist2, c(1,2), FUN=function(x){if(x>1.303){return(TRUE)}else{return(FALSE)}}))
PAlist2$Pathway <- gsub("\\_.*", "", rownames(PAlist2))
PAlist2$Contrast <- gsub(".*\\_", "", rownames(PAlist2))
#PAlist2 <- reshape2::melt(PAlist2)
#colnames(PAlist2) <- c("Pathway", "Algorithm", "Contrast", "negativelog10FDR")
head(PAlist2)
ComplexUpset::upset(
PAlist2,
colnames(PAlist2)[1:5],
base_annotations=list(
'Intersection Size'=intersection_size(mode = 'intersect' , bar_number_threshold=0.45, text_colors = c(on_background = "black", on_bar = "black"), size=0, mapping=aes(fill=Contrast), position = 'stack' #, #text_mapping = aes(colour=Contrast),
#text = list(position=position_stack())
) + ylim(0, 150) + scale_fill_manual(values=c(
"1% O2, CyA+ vs 1% O2, CyA-"='#E41A1C', "19% O2, CyA- vs 1% O2, CyA+"='#377EB8',
"1% O2, CyA- vs 19% O2, CyA-"='#4DAF4A'
)) + scale_color_manual(values=c(
"1% O2, CyA+ vs 1% O2, CyA-"='#E41A1C', "19% O2, CyA- vs 1% O2, CyA+"='#377EB8',
"1% O2, CyA- vs 19% O2, CyA-"='#4DAF4A'
))
) ,
width_ratio=0.3,
set_sizes=(upset_set_size(position='right',geom=geom_bar(stat='count', position = position_dodge(),aes(fill=Contrast)))+ scale_fill_manual(values=c(
"1% O2, CyA+ vs 1% O2, CyA-"='#E41A1C', "19% O2, CyA- vs 1% O2, CyA+"='#377EB8',
"1% O2, CyA- vs 19% O2, CyA-"='#4DAF4A'
))),
# moves legends over the set sizes
guides='over'
)
require(ComplexUpset)
PAlist2 <- lapply(PAlist, function(x){return(x[x$Method %in% c("Concatenated", "Combined", "mBONITA"), intersect(colnames(x), c('Contrast', 'Pathway',"Method", 'negativelog10FDR'))])}) #lapply(PAlist, function(x){return(x[x$Pathway %in% gmt$Pathway & x$Method %in% c("Concatenated", "Combined"), intersect(colnames(x), c('Contrast', 'Pathway',"Method", 'negativelog10FDR'))])})
PAlist2$Pathway <- unlist(lapply(PAlist2$Pathway, function(x){if(x %in% gmt$Pathway){return(paste0(x, "**"))}}))
PAlist2 <- Filter(function(x) dim(x)[1] > 0, PAlist2)
for (i in names(PAlist2)){
PAlist2[[i]]$Algorithm <- i
}
PAlist2 <- do.call(rbind,PAlist2)
rownames(PAlist2) <- 1:nrow(PAlist2)
PAlist2$Method <- 'Combined'
PAlist2 <- reshape2::acast(PAlist2, Pathway + Contrast ~ Algorithm , value.var = 'negativelog10FDR')
PAlist2[is.na(PAlist2)] <- 0
PAlist2 <- as.data.frame(apply(PAlist2, c(1,2), FUN=function(x){if(x>1.303){return(TRUE)}else{return(FALSE)}}))
PAlist2$Pathway <- gsub("\\_.*", "", rownames(PAlist2))
PAlist2$Contrast <- gsub(".*\\_", "", rownames(PAlist2))
#PAlist2 <- reshape2::melt(PAlist2)
#colnames(PAlist2) <- c("Pathway", "Algorithm", "Contrast", "negativelog10FDR")
head(PAlist2)
ComplexUpset::upset(
PAlist2,
colnames(PAlist2)[1:5],
base_annotations=list(
'Intersection Size'=intersection_size(mode = 'intersect' , bar_number_threshold=0.45, text_colors = c(on_background = "black", on_bar = "black"), size=0, mapping=aes(fill=Contrast), position = 'stack' #, #text_mapping = aes(colour=Contrast),
#text = list(position=position_stack())
) + ylim(0, 150) + scale_fill_manual(values=c(
"1% O2, CyA+ vs 1% O2, CyA-"='#E41A1C', "19% O2, CyA- vs 1% O2, CyA+"='#377EB8',
"1% O2, CyA- vs 19% O2, CyA-"='#4DAF4A'
)) + scale_color_manual(values=c(
"1% O2, CyA+ vs 1% O2, CyA-"='#E41A1C', "19% O2, CyA- vs 1% O2, CyA+"='#377EB8',
"1% O2, CyA- vs 19% O2, CyA-"='#4DAF4A'
))
) ,
width_ratio=0.3,
set_sizes=(upset_set_size(position='right',geom=geom_bar(stat='count', position = position_dodge(),aes(fill=Contrast)))+ scale_fill_manual(values=c(
"1% O2, CyA+ vs 1% O2, CyA-"='#E41A1C', "19% O2, CyA- vs 1% O2, CyA+"='#377EB8',
"1% O2, CyA- vs 19% O2, CyA-"='#4DAF4A'
), guide='none')),
# moves legends over the set sizes
guides='over'
)
require(ComplexUpset)
PAlist2 <- lapply(PAlist, function(x){return(x[x$Method %in% c("Concatenated", "Combined", "mBONITA"), intersect(colnames(x), c('Contrast', 'Pathway',"Method", 'negativelog10FDR'))])}) #lapply(PAlist, function(x){return(x[x$Pathway %in% gmt$Pathway & x$Method %in% c("Concatenated", "Combined"), intersect(colnames(x), c('Contrast', 'Pathway',"Method", 'negativelog10FDR'))])})
PAlist2$Pathway <- unlist(lapply(PAlist2$Pathway, function(x){if(x %in% gmt$Pathway){return(paste0(x, "**"))}}))
PAlist2 <- Filter(function(x) dim(x)[1] > 0, PAlist2)
for (i in names(PAlist2)){
PAlist2[[i]]$Algorithm <- i
}
PAlist2 <- do.call(rbind,PAlist2)
rownames(PAlist2) <- 1:nrow(PAlist2)
PAlist2$Method <- 'Combined'
PAlist2 <- reshape2::acast(PAlist2, Pathway + Contrast ~ Algorithm , value.var = 'negativelog10FDR')
PAlist2[is.na(PAlist2)] <- 0
PAlist2 <- as.data.frame(apply(PAlist2, c(1,2), FUN=function(x){if(x>1.303){return(TRUE)}else{return(FALSE)}}))
PAlist2$Pathway <- gsub("\\_.*", "", rownames(PAlist2))
PAlist2$Contrast <- gsub(".*\\_", "", rownames(PAlist2))
#PAlist2 <- reshape2::melt(PAlist2)
#colnames(PAlist2) <- c("Pathway", "Algorithm", "Contrast", "negativelog10FDR")
head(PAlist2)
ComplexUpset::upset(
PAlist2,
colnames(PAlist2)[1:5],
base_annotations=list(
'Intersection Size'=intersection_size(mode = 'intersect' , bar_number_threshold=0.45, text_colors = c(on_background = "black", on_bar = "black"), size=0, mapping=aes(fill=Contrast), position = 'stack' #, #text_mapping = aes(colour=Contrast),
#text = list(position=position_stack())
) + ylim(0, 150) + scale_fill_manual(values=c(
"1% O2, CyA+ vs 1% O2, CyA-"='#E41A1C', "19% O2, CyA- vs 1% O2, CyA+"='#377EB8',
"1% O2, CyA- vs 19% O2, CyA-"='#4DAF4A'
)) + scale_color_manual(values=c(
"1% O2, CyA+ vs 1% O2, CyA-"='#E41A1C', "19% O2, CyA- vs 1% O2, CyA+"='#377EB8',
"1% O2, CyA- vs 19% O2, CyA-"='#4DAF4A'
))
) ,
width_ratio=0.3,
set_sizes=(),
require(ComplexUpset)
PAlist2 <- lapply(PAlist, function(x){return(x[x$Method %in% c("Concatenated", "Combined", "mBONITA"), intersect(colnames(x), c('Contrast', 'Pathway',"Method", 'negativelog10FDR'))])}) #lapply(PAlist, function(x){return(x[x$Pathway %in% gmt$Pathway & x$Method %in% c("Concatenated", "Combined"), intersect(colnames(x), c('Contrast', 'Pathway',"Method", 'negativelog10FDR'))])})
PAlist2$Pathway <- unlist(lapply(PAlist2$Pathway, function(x){if(x %in% gmt$Pathway){return(paste0(x, "**"))}}))
PAlist2 <- Filter(function(x) dim(x)[1] > 0, PAlist2)
for (i in names(PAlist2)){
PAlist2[[i]]$Algorithm <- i
}
PAlist2 <- do.call(rbind,PAlist2)
rownames(PAlist2) <- 1:nrow(PAlist2)
PAlist2$Method <- 'Combined'
PAlist2 <- reshape2::acast(PAlist2, Pathway + Contrast ~ Algorithm , value.var = 'negativelog10FDR')
PAlist2[is.na(PAlist2)] <- 0
PAlist2 <- as.data.frame(apply(PAlist2, c(1,2), FUN=function(x){if(x>1.303){return(TRUE)}else{return(FALSE)}}))
PAlist2$Pathway <- gsub("\\_.*", "", rownames(PAlist2))
PAlist2$Contrast <- gsub(".*\\_", "", rownames(PAlist2))
#PAlist2 <- reshape2::melt(PAlist2)
#colnames(PAlist2) <- c("Pathway", "Algorithm", "Contrast", "negativelog10FDR")
head(PAlist2)
ComplexUpset::upset(
PAlist2,
colnames(PAlist2)[1:5],
base_annotations=list(
'Intersection Size'=intersection_size(mode = 'intersect' , bar_number_threshold=0.45, text_colors = c(on_background = "black", on_bar = "black"), size=0, mapping=aes(fill=Contrast), position = 'stack' #, #text_mapping = aes(colour=Contrast),
#text = list(position=position_stack())
) + ylim(0, 150) + scale_fill_manual(values=c(
"1% O2, CyA+ vs 1% O2, CyA-"='#E41A1C', "19% O2, CyA- vs 1% O2, CyA+"='#377EB8',
"1% O2, CyA- vs 19% O2, CyA-"='#4DAF4A'
)) + scale_color_manual(values=c(
"1% O2, CyA+ vs 1% O2, CyA-"='#E41A1C', "19% O2, CyA- vs 1% O2, CyA+"='#377EB8',
"1% O2, CyA- vs 19% O2, CyA-"='#4DAF4A'
))
) ,
width_ratio=0.3,
set_sizes=FALSE,
# moves legends over the set sizes
guides='over'
)
require(ComplexUpset)
PAlist2 <-
lapply(PAlist, function(x) {
return(x[x$Method %in% c("Concatenated", "Combined", "mBONITA"), intersect(colnames(x),
c('Contrast', 'Pathway', "Method", 'negativelog10FDR'))])
}) #lapply(PAlist, function(x){return(x[x$Pathway %in% gmt$Pathway & x$Method %in% c("Concatenated", "Combined"), intersect(colnames(x), c('Contrast', 'Pathway',"Method", 'negativelog10FDR'))])})
PAlist2$Pathway <-
unlist(lapply(PAlist2$Pathway, function(x) {
if (x %in% gmt$Pathway) {
return(paste0(x, "**"))
}
}))
PAlist2 <- Filter(function(x)
dim(x)[1] > 0, PAlist2)
for (i in names(PAlist2)) {
PAlist2[[i]]$Algorithm <- i
}
PAlist2 <- do.call(rbind, PAlist2)
rownames(PAlist2) <- 1:nrow(PAlist2)
PAlist2$Method <- 'Combined'
PAlist2 <-
reshape2::acast(PAlist2, Pathway + Contrast ~ Algorithm , value.var = 'negativelog10FDR')
PAlist2[is.na(PAlist2)] <- 0
PAlist2 <-
as.data.frame(apply(
PAlist2,
c(1, 2),
FUN = function(x) {
if (x > 1.303) {
return(TRUE)
} else{
return(FALSE)
}
))
PAlist2$Pathway <- gsub("\\_.*", "", rownames(PAlist2))
PAlist2$Contrast <- gsub(".*\\_", "", rownames(PAlist2))
#PAlist2 <- reshape2::melt(PAlist2)
#colnames(PAlist2) <- c("Pathway", "Algorithm", "Contrast", "negativelog10FDR")
head(PAlist2)
ComplexUpset::upset(
PAlist2,
colnames(PAlist2)[1:5],
base_annotations = list(
'Intersection Size' = intersection_size(
mode = 'intersect' ,
bar_number_threshold = 0.45,
text_colors = c(on_background = "black", on_bar = "black"),
size = 0,
mapping = aes(fill = Contrast),
position = 'stack' #, #text_mapping = aes(colour=Contrast),
#text = list(position=position_stack())
) + ylim(0, 150) + scale_fill_manual(
values = c(
"1% O2, CyA+ vs 1% O2, CyA-" = '#E41A1C',
"19% O2, CyA- vs 1% O2, CyA+" = '#377EB8',
"1% O2, CyA- vs 19% O2, CyA-" = '#4DAF4A'
)
) ,
width_ratio = 0.3,
set_sizes = FALSE,
# moves legends over the set sizes
#guides = 'over'
)
require(ComplexUpset)
PAlist2 <-
lapply(PAlist, function(x) {
return(x[x$Method %in% c("Concatenated", "Combined", "mBONITA"), intersect(colnames(x),
c('Contrast', 'Pathway', "Method", 'negativelog10FDR'))])
}) #lapply(PAlist, function(x){return(x[x$Pathway %in% gmt$Pathway & x$Method %in% c("Concatenated", "Combined"), intersect(colnames(x), c('Contrast', 'Pathway',"Method", 'negativelog10FDR'))])})
PAlist2$Pathway <-
unlist(lapply(PAlist2$Pathway, function(x) {
if (x %in% gmt$Pathway) {
return(paste0(x, "**"))
}
}))
PAlist2 <- Filter(function(x)
dim(x)[1] > 0, PAlist2)
for (i in names(PAlist2)) {
PAlist2[[i]]$Algorithm <- i
}
PAlist2 <- do.call(rbind, PAlist2)
rownames(PAlist2) <- 1:nrow(PAlist2)
PAlist2$Method <- 'Combined'
PAlist2 <-
reshape2::acast(PAlist2, Pathway + Contrast ~ Algorithm , value.var = 'negativelog10FDR')
PAlist2[is.na(PAlist2)] <- 0
PAlist2 <-
as.data.frame(apply(
PAlist2,
c(1, 2),
FUN = function(x) {
if (x > 1.303) {
return(TRUE)
} else{
return(FALSE)
}
))
PAlist2$Pathway <- gsub("\\_.*", "", rownames(PAlist2))
PAlist2$Contrast <- gsub(".*\\_", "", rownames(PAlist2))
#PAlist2 <- reshape2::melt(PAlist2)
#colnames(PAlist2) <- c("Pathway", "Algorithm", "Contrast", "negativelog10FDR")
head(PAlist2)
ComplexUpset::upset(
PAlist2,
colnames(PAlist2)[1:5],
base_annotations = list(
'Intersection Size' = intersection_size(
mode = 'intersect' ,
bar_number_threshold = 0.45,
text_colors = c(on_background = "black", on_bar = "black"),
size = 0,
mapping = aes(fill = Contrast),
position = 'stack' #, #text_mapping = aes(colour=Contrast),
#text = list(position=position_stack())
) + ylim(0, 150) + scale_fill_manual(
values = c(
"1% O2, CyA+ vs 1% O2, CyA-" = '#E41A1C',
"19% O2, CyA- vs 1% O2, CyA+" = '#377EB8',
"1% O2, CyA- vs 19% O2, CyA-" = '#4DAF4A'
)
) ,
width_ratio = 0.3,
set_sizes = FALSE,
# moves legends over the set sizes
guide = 'over'
)
