visList <- makeVisList(PAlist, "X1O2PlusCyA - X1O2NoCyA")
png(filename = "upset_X1O2PlusCyA - X1O2NoCyA.png", width = 4, height = 8, pointsize = 14, res = 600, units = 'in')
upset(fromList(visList), order.by = c("freq", "degree"), mb.ratio = c(0.55, 0.45), empty.intersections = NULL, point.size = 5, line.size = 1 , mainbar.y.label = "Intersections", sets.x.label = "Pathways", text.scale = c(2,2, 2, 2, 2, 2), number.angles = 0, main.bar.color = 'black', sets.bar.color = 'black', shade.color = 'white', matrix.color = 'black')
dev.off()
pathways <- as.vector(read.table("PATHWAYS IN HIF1A NETWORK KEGG IDS.txt", header=FALSE, fill=TRUE)[,1])
print(pathways)
gmt <- read.table('kegg_networks_edited.gmt', header=FALSE, fill=TRUE, sep = "\t")[,1:2]
colnames(gmt) <- c('Pathway', 'KEGGID')
gmt <- na.omit(gmt[gmt$KEGGID %in% pathways, c("KEGGID", "Pathway")])
rownames(gmt) <- gmt$KEGGID
print(gmt)
PAlist2 <- lapply(PAlist, function(x){return(x[x$Pathway %in% gmt$Pathway & x$Method %in% c("Concatenated", "Combined"), intersect(colnames(x), c('Contrast', 'Pathway',"Method", 'negativelog10FDR'))])})
PAlist2 <- Filter(function(x) dim(x)[1] > 0, PAlist2)
for (i in names(PAlist2)){
PAlist2[[i]]$Algorithm <- i
}
PAlist2 <- do.call(rbind,PAlist2)
rownames(PAlist2) <- 1:nrow(PAlist2)
PAlist2$Method <- 'Combined'
PAlist2
reshape2::acast(PAlist2, Pathway ~ Algorithm ~ Contrast, value.var = 'negativelog10FDR')
PAlist2 <- reshape2::acast(PAlist2, Pathway ~ Algorithm ~ Contrast, value.var = 'negativelog10FDR')
PAlist2[is.na(PAlist2)] <- 1
PAlist2
PAlist2 <- lapply(PAlist, function(x){return(x[x$Pathway %in% gmt$Pathway & x$Method %in% c("Concatenated", "Combined"), intersect(colnames(x), c('Contrast', 'Pathway',"Method", 'negativelog10FDR'))])})
PAlist2 <- Filter(function(x) dim(x)[1] > 0, PAlist2)
for (i in names(PAlist2)){
PAlist2[[i]]$Algorithm <- i
}
PAlist2 <- do.call(rbind,PAlist2)
rownames(PAlist2) <- 1:nrow(PAlist2)
PAlist2$Method <- 'Combined'
PAlist2
PAlist2 <- reshape2::acast(PAlist2, Pathway ~ Algorithm ~ Contrast, value.var = 'negativelog10FDR')
PAlist2[is.na(PAlist2)] <- 0
PAlist2
PAlist2[,,'X19O2NoCyA - X1O2NoCyA']
melt(Alist2[,,'X19O2NoCyA - X1O2NoCyA'])
reshape2::melt(PAlist2[,,'X19O2NoCyA - X1O2NoCyA'])
temp <- reshape2::melt(PAlist2[,,'X19O2NoCyA - X1O2NoCyA'])
colnames(temp) <- c("Pathway", "Algorithm", "-log10(BH-pvalue)")
ggplot(temp, aes(Algorithm, Pathway, fill= "-log10(BH-pvalue)")) +
geom_tile() +
scale_fill_gradient(low="white", high="blue") +
theme_ipsum()
temp <- reshape2::melt(PAlist2[,,'X19O2NoCyA - X1O2NoCyA'])
colnames(temp) <- c("Pathway", "Algorithm", "-log10(BH-pvalue)")
ggplot(temp, aes(Algorithm, Pathway, fill= "-log10(BH-pvalue)")) +
geom_tile() +
scale_fill_gradient(low="white", high="blue")
temp <- reshape2::melt(PAlist2[,,'X19O2NoCyA - X1O2NoCyA'])
colnames(temp) <- c("Pathway", "Algorithm", "negativelog10FDR")
ggplot(temp, aes(Algorithm, Pathway, fill=negativelog10FDR)) +
geom_tile() +
scale_fill_gradient(low="white", high="blue")
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) +
geom_tile() +
scale_fill_gradient(low="white", high="blue")
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) +
geom_tile()
Heatmap(matrix(PAlist2[,,'X19O2NoCyA - X1O2NoCyA']), name = "mat",
top_annotation = HeatmapAnnotation(foo = anno_block(gp = gpar(fill = 2:4))),
column_km = 3)
require(ComplexHeatmap)
Heatmap(matrix(PAlist2[,,'X19O2NoCyA - X1O2NoCyA']), name = "mat",
top_annotation = HeatmapAnnotation(foo = anno_block(gp = gpar(fill = 2:4))),
column_km = 3)
require(ComplexHeatmap)
Heatmap(as.matrix(PAlist2[,,'X19O2NoCyA - X1O2NoCyA']), name = "-log10(FDR)",
top_annotation = HeatmapAnnotation(foo = anno_block(gp = gpar(fill = 2:4))),
column_km = 3)
require(ComplexHeatmap)
Heatmap(as.matrix(PAlist2[,,'X19O2NoCyA - X1O2NoCyA']), name = "-log10(FDR)",
top_annotation = HeatmapAnnotation(foo = anno_block(gp = gpar(fill = 2:4))))
Heatmap(as.matrix(PAlist2[,,'X19O2NoCyA - X1O2NoCyA']), name = "-log10(FDR)", top_annotation = HeatmapAnnotation(foo = anno_block(gp = gpar(fill = 1:3))))
require(ComplexHeatmap)
Heatmap(as.matrix(PAlist2[,,'X19O2NoCyA - X1O2NoCyA']), name = "-log10(FDR)", top_annotation = HeatmapAnnotation(foo = anno_block(gp = gpar(fill = 2:4),
labels = c("group1", "group2", "group3"),
labels_gp = gpar(col = "white", fontsize = 10))))
PAlist2[,,'X19O2NoCyA - X1O2NoCyA']
as.matrix(PAlist2[,,'X19O2NoCyA - X1O2NoCyA'])
Heatmap(as.matrix(PAlist2[,,'X19O2NoCyA - X1O2NoCyA']), name = "-log10(FDR)")
Heatmap(as.matrix(PAlist2[,,'X19O2NoCyA - X1O2NoCyA']), name = "-log10(FDR)",cluster_columns = FALSE, top_annotation = HeatmapAnnotation(foo = anno_block(gp = gpar(fill = 2:4), labels = c("group1", "group2", "group3"), labels_gp = gpar(col = "white", fontsize = 10))))
require(ComplexHeatmap)
Heatmap(t(as.matrix(PAlist2[,,'X19O2NoCyA - X1O2NoCyA'])), name = "-log10(FDR)",cluster_columns = FALSE, top_annotation = HeatmapAnnotation(foo = anno_block(gp = gpar(fill = 2:4), labels = c("group1", "group2", "group3"), labels_gp = gpar(col = "white", fontsize = 10))))
Heatmap(as.matrix(PAlist2[,,'X19O2NoCyA - X1O2NoCyA']), name = "-log10(FDR)",cluster_columns = FALSE, top_annotation = HeatmapAnnotation(foo = anno_block(labels = c("group1", "group2", "group3"), labels_gp = gpar(col = "white", fontsize = 10))))
require(ComplexHeatmap)
Heatmap(as.matrix(PAlist2[,,'X19O2NoCyA - X1O2NoCyA']), name = "-log10(FDR)",cluster_columns = FALSE, top_annotation = HeatmapAnnotation(foo = anno_block(labels = colnames(PAlist2[,,'X19O2NoCyA - X1O2NoCyA']), labels_gp = gpar(col = "white", fontsize = 10))))
require(ComplexHeatmap)
Heatmap(as.matrix(PAlist2[,,'X19O2NoCyA - X1O2NoCyA']), name = "-log10(FDR)",cluster_columns = FALSE, top_annotation = HeatmapAnnotation(foo = anno_block(labels = colnames(PAlist2[,,'X19O2NoCyA - X1O2NoCyA']))
require(ComplexHeatmap)
Heatmap(as.matrix(PAlist2[,,'X19O2NoCyA - X1O2NoCyA']), name = "-log10(FDR)",cluster_columns = FALSE, top_annotation = HeatmapAnnotation(foo = anno_block(labels = colnames(PAlist2[,,'X19O2NoCyA - X1O2NoCyA'])))
require(ComplexHeatmap)
Heatmap(as.matrix(PAlist2[,,'X19O2NoCyA - X1O2NoCyA']), name = "-log10(FDR)",cluster_columns = FALSE)
Heatmap(as.matrix(PAlist2[,,'X19O2NoCyA - X1O2NoCyA']), name = "-log10(FDR)",cluster_columns = FALSE, cluster_rows = FALSE)
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) + geom_tile() + scale_fill_gradient(low="white", high="blue")
PAlist2
PAlist2 <- lapply(PAlist, function(x){return(x[x$Pathway %in% gmt$Pathway & x$Method %in% c("Concatenated", "Combined"), intersect(colnames(x), c('Contrast', 'Pathway',"Method", 'negativelog10FDR'))])})
PAlist2 <- Filter(function(x) dim(x)[1] > 0, PAlist2)
for (i in names(PAlist2)){
PAlist2[[i]]$Algorithm <- i
}
PAlist2 <- do.call(rbind,PAlist2)
rownames(PAlist2) <- 1:nrow(PAlist2)
PAlist2$Method <- 'Combined'
PAlist2
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) + geom_tile() + scale_fill_gradient(low="white", high="blue")
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) + geom_tile() + scale_fill_gradient(low="white", high="blue") + facet_grid(Contrast)
PAlsit2
PAlist2
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) + geom_tile() + scale_fill_gradient(low="white", high="blue") + facet_wrap(Contrast)
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) + geom_tile() + scale_fill_gradient(low="white", high="blue") + facet_wrap(~Contrast)
threshold <- 0.05
cwd <- getwd()
methods <- c("CAMERA", "LeapR", "PaintOmics", "ActivePathways", "mBONITA")
PAlist <- vector(mode = "list", length = length(methods))
names(PAlist) <- methods
PAlist[["CAMERA"]] <- read.csv(paste0(cwd, "/reactomeGSA-camera/camera_combinedPvalues.csv"), row.names = 1)
temp <- PAlist[["CAMERA"]]$FDR < threshold #PValue < 0.01
PAlist[["CAMERA"]] <- na.omit(PAlist[["CAMERA"]][temp,])
PAlist[["LeapR"]] <- read.csv(paste0(cwd, "/leapR/leapR_allResults.csv"))
temp <- PAlist[["LeapR"]]$BH_pvalue < threshold
PAlist[["LeapR"]] <- PAlist[["LeapR"]][temp,]
PAlist[["LeapR"]]$Pathway <- trimws(gsub("KEGG|_|\\d+$", " ", PAlist[["LeapR"]]$Pathway))
PAlist[["PaintOmics"]]<- as.data.frame(read.csv(paste0(cwd, "/paintomics/paintomics_allResults.csv"), row.names = 1))
colnames(PAlist[["PaintOmics"]])[1] <- "Pathway"
temp <- PAlist[["PaintOmics"]]$Combined.pValue.Fisher..FDR.BH < threshold
PAlist[["PaintOmics"]] <- PAlist[["PaintOmics"]][temp,]
PAlist[["ActivePathways"]]<- read.csv(paste0(cwd, "/ActivePathways/activePathways_allResults.csv"), row.names = NULL)
temp <- PAlist[["ActivePathways"]]$adjusted.p.val < threshold
PAlist[["ActivePathways"]] <- PAlist[["ActivePathways"]][temp,]
PAlist[["mBONITA"]]<- read.csv(paste0(cwd, "/mBonita_pvalues/mBonita_allResults.csv"), row.names = 1)
temp <- PAlist[["mBONITA"]]$FDR < threshold
PAlist[["mBONITA"]] <- PAlist[["mBONITA"]][temp,]
levels(PAlist$mBONITA$Contrast) <- c("X19O2NoCyA - X1O2PlusCyA", "X19O2NoCyA - X1O2NoCyA", "X1O2PlusCyA - X1O2NoCyA" )
#PAlist[[""]]<- read.csv(paste0(cwd, ""))
require(stringr)
makeVisList <- function(tempPAlist, contrast) {
visList <- tempPAlist
tempPAlist <-
lapply(tempPAlist, function(x) {
return(x[x$Contrast == contrast, ])
})
visList[["CAMERA"]] <-
unique(str_to_title(trimws(as.vector(tempPAlist[["CAMERA"]]$Pathway[tempPAlist[["CAMERA"]]$Method == "Combined"]))))
visList[["LeapR"]] <-
unique(str_to_title(as.vector(tempPAlist[["LeapR"]]$Pathway[tempPAlist[["LeapR"]]$Method == "Phosphoproteomics"]))) #NO COMBINED RESULTS YET
visList[["PaintOmics"]] <-
unique(str_to_title(trimws(as.vector(
tempPAlist[["PaintOmics"]]$Pathway.name
)))) #ALREADY FILTERED TO COMBINED PVALS IN PREVIOUS STEP
visList[["mBONITA"]] <-
unique(str_to_title(trimws(as.vector(tempPAlist[["mBONITA"]]$Pathway[tempPAlist[["mBONITA"]]$Method == "Concatenated"]))))
visList[["ActivePathways"]] <-
unique(str_to_title(trimws(as.vector(
tempPAlist[["ActivePathways"]]$Pathway
))))
visList <- lapply(visList, function(x){if(length(x) > 0){return(x)}else{return(NA)}})
visList <- visList[!is.na(visList)]
print(visList)
return(visList)
}
require(UpSetR)
require(ggplot2)
visList <- makeVisList(PAlist, "X19O2NoCyA - X1O2PlusCyA")
png(filename = "upset_X19O2NoCyA - X1O2PlusCyA.png", width = 4, height = 8, pointsize = 14, res = 600, units = 'in')
upset(fromList(visList), order.by = c("freq", "degree"), mb.ratio = c(0.55, 0.45), empty.intersections = NULL, point.size = 5, line.size = 1 , mainbar.y.label = "Intersections", sets.x.label = "Pathways", text.scale = c(2,2, 2, 2, 2, 2), number.angles = 0, main.bar.color = 'black', sets.bar.color = 'black', shade.color = 'white', matrix.color = 'black')
dev.off()
visList <- makeVisList(PAlist, "X19O2NoCyA - X1O2NoCyA")
png(filename = "upset_X19O2NoCyA - X1O2NoCyA.png", width = 4, height = 8, pointsize = 14, res = 600, units = 'in')
upset(fromList(visList), order.by = c("freq", "degree"), mb.ratio = c(0.55, 0.45), empty.intersections = NULL, point.size = 5, line.size = 1 , mainbar.y.label = "Intersections", sets.x.label = "Pathways", text.scale = c(2,2, 2, 2, 2, 2), number.angles = 0, main.bar.color = 'black', sets.bar.color = 'black', shade.color = 'white', matrix.color = 'black')
dev.off()
visList <- makeVisList(PAlist, "X1O2PlusCyA - X1O2NoCyA")
png(filename = "upset_X1O2PlusCyA - X1O2NoCyA.png", width = 4, height = 8, pointsize = 14, res = 600, units = 'in')
upset(fromList(visList), order.by = c("freq", "degree"), mb.ratio = c(0.55, 0.45), empty.intersections = NULL, point.size = 5, line.size = 1 , mainbar.y.label = "Intersections", sets.x.label = "Pathways", text.scale = c(2,2, 2, 2, 2, 2), number.angles = 0, main.bar.color = 'black', sets.bar.color = 'black', shade.color = 'white', matrix.color = 'black')
dev.off()
pathways <- as.vector(read.table("PATHWAYS IN HIF1A NETWORK KEGG IDS.txt", header=FALSE, fill=TRUE)[,1])
print(pathways)
gmt <- read.table('kegg_networks_edited.gmt', header=FALSE, fill=TRUE, sep = "\t")[,1:2]
colnames(gmt) <- c('Pathway', 'KEGGID')
gmt <- na.omit(gmt[gmt$KEGGID %in% pathways, c("KEGGID", "Pathway")])
rownames(gmt) <- gmt$KEGGID
print(gmt)
PAlist2 <- lapply(PAlist, function(x){return(x[x$Pathway %in% gmt$Pathway & x$Method %in% c("Concatenated", "Combined"), intersect(colnames(x), c('Contrast', 'Pathway',"Method", 'negativelog10FDR'))])})
PAlist2 <- Filter(function(x) dim(x)[1] > 0, PAlist2)
for (i in names(PAlist2)){
PAlist2[[i]]$Algorithm <- i
}
PAlist2 <- do.call(rbind,PAlist2)
rownames(PAlist2) <- 1:nrow(PAlist2)
PAlist2$Method <- 'Combined'
PAlist2
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) + geom_tile() + scale_fill_gradient(low="white", high="blue") + facet_wrap(~Contrast)
png(filename = "heatmap_HIF1pathways.png", width = 4, height = 8, pointsize = 14, res = 600, units = 'in')
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) + geom_tile() + scale_fill_gradient(low="white", high="blue") + facet_wrap(~Contrast)
dev.off()
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) + geom_tile() + scale_fill_gradient(low="white", high="blue") + facet_wrap(~Contrast)
png(filename = "heatmap_HIF1pathways.png", width = 8, height = 4, pointsize = 14, res = 600, units = 'in')
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) + geom_tile() + scale_fill_gradient(low="white", high="blue") + facet_wrap(~Contrast)
dev.off()
require(ggsci)
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) + geom_tile() + scale_fill_gsea()+ facet_wrap(~Contrast)
png(filename = "heatmap_HIF1pathways.png", width = 8, height = 4, pointsize = 14, res = 600, units = 'in')
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) + geom_tile() + scale_fill_gradient(low="white", high="blue") + facet_wrap(~Contrast)
dev.off()
require(ggsci)
require(ggpubr)
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) + geom_tile() + scale_fill_gsea()+ facet_wrap(~Contrast) + ggpubr()
require(ggsci)
require(ggpubr)
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) + geom_tile() + scale_fill_gsea()+ facet_wrap(~Contrast) + theme_pubr()
png(filename = "heatmap_HIF1pathways.png", width = 8, height = 4, pointsize = 14, res = 600, units = 'in')
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) + geom_tile() + scale_fill_gradient(low="white", high="blue") + facet_wrap(~Contrast) + theme_pubr()
dev.off()
require(ggsci)
require(ggpubr)
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) + geom_tile() + scale_fill_gsea()+ facet_wrap(~Contrast) + theme_pubr()
png(filename = "heatmap_HIF1pathways.png", width = 10, height = 4, pointsize = 14, res = 600, units = 'in')
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) + geom_tile() + scale_fill_gradient(low="white", high="blue") + facet_wrap(~Contrast) + theme_pubr()
dev.off()
require(ggsci)
require(ggpubr)
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) + geom_tile() + scale_fill_gsea()+ facet_wrap(~Contrast) + theme_pubr()
png(filename = "heatmap_HIF1pathways.png", width = 10, height = 4, pointsize = 14, res = 600, units = 'in')
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) + geom_tile() + scale_fill_gsea() + facet_wrap(~Contrast) + theme_pubr()
dev.off()
require(ggsci)
require(ggpubr)
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) + geom_tile() + scale_fill_gsea()+ facet_wrap(~Contrast) + theme_pubr() + rotate_y_text(90)
png(filename = "heatmap_HIF1pathways.png", width = 10, height = 4, pointsize = 14, res = 600, units = 'in')
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) + geom_tile() + scale_fill_gsea() + facet_wrap(~Contrast) + theme_pubr() + rotate_y_text(90)
dev.off()
require(ggsci)
require(ggpubr)
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) + geom_tile() + scale_fill_gsea()+ facet_wrap(~Contrast) + theme_pubr() + rotate_x_text(90)
png(filename = "heatmap_HIF1pathways.png", width = 10, height = 4, pointsize = 14, res = 600, units = 'in')
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) + geom_tile() + scale_fill_gsea() + facet_wrap(~Contrast) + theme_pubr() + rotate_x_text(90)
dev.off()
require(ggsci)
require(ggpubr)
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) + geom_tile(color = "gray") + scale_fill_gsea()+ facet_wrap(~Contrast) + theme_pubr() + rotate_x_text(90)
png(filename = "heatmap_HIF1pathways.png", width = 10, height = 4, pointsize = 14, res = 600, units = 'in')
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) + geom_tile() + scale_fill_gsea() + facet_wrap(~Contrast) + theme_pubr() + rotate_x_text(90)
dev.off()
require(ggsci)
require(ggpubr)
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) + geom_tile(color = "gray") + scale_fill_gsea()+ facet_wrap(~Contrast) + theme_pubr() + rotate_x_text(90)
png(filename = "heatmap_HIF1pathways.png", width = 10, height = 4, pointsize = 14, res = 600, units = 'in')
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) + geom_tile() + scale_fill_gsea() + facet_wrap(~Contrast) + theme_pubr() + rotate_x_text(90) + color = "gray"
require(ggsci)
require(ggpubr)
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) + geom_tile(color = "gray") + scale_fill_gsea()+ facet_wrap(~Contrast) + theme_pubr() + rotate_x_text(90)
png(filename = "heatmap_HIF1pathways.png", width = 10, height = 4, pointsize = 14, res = 600, units = 'in')
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) + geom_tile(color = "gray") + scale_fill_gsea() + facet_wrap(~Contrast) + theme_pubr() + rotate_x_text(90)
dev.off()
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) + geom_tile(color = "black") + scale_fill_gsea()+ facet_wrap(~Contrast) + theme_pubr() + rotate_x_text(90)
require(ggsci)
require(ggpubr)
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) + geom_tile() + scale_fill_gsea()+ facet_wrap(~Contrast) + theme_pubr() + rotate_x_text(90) + theme(panel.grid.major = element_line(colour = "black"))
png(filename = "heatmap_HIF1pathways.png", width = 10, height = 4, pointsize = 14, res = 600, units = 'in')
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) + geom_tile(color = "gray") + scale_fill_gsea() + facet_wrap(~Contrast) + theme_pubr() + rotate_x_text(90) + theme(panel.grid.major = element_line(colour = "black"))
dev.off()
require(ggsci)
require(ggpubr)
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) + geom_tile(color = 'black') + scale_fill_gsea()+ facet_wrap(~Contrast) #+ theme_pubr() + rotate_x_text(90) #+ theme(panel.grid.major = element_line(colour = "black"))
png(filename = "heatmap_HIF1pathways.png", width = 10, height = 4, pointsize = 14, res = 600, units = 'in')
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) + geom_tile(color = "gray") + scale_fill_gsea() + facet_wrap(~Contrast) + theme_pubr() + rotate_x_text(90) #+ theme(panel.grid.major = element_line(colour = "black"))
dev.off()
require(ggsci)
require(ggpubr)
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) + geom_tile(color = 'black') + scale_fill_gsea()+ facet_wrap(~Contrast) + theme_pubr() #+ rotate_x_text(90) #+ theme(panel.grid.major = element_line(colour = "black"))
png(filename = "heatmap_HIF1pathways.png", width = 10, height = 4, pointsize = 14, res = 600, units = 'in')
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) + geom_tile(color = "gray") + scale_fill_gsea() + facet_wrap(~Contrast) + theme_pubr() + rotate_x_text(90) #+ theme(panel.grid.major = element_line(colour = "black"))
dev.off()
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) + geom_tile(color = 'black') + scale_fill_gsea()+ facet_wrap(~Contrast) + theme_pubr() #+ rotate_x_text(90) #+ theme(panel.grid.major = element_line(colour = "black"))
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) + geom_tile(color = 'black') + scale_fill_gsea() + facet_wrap(~Contrast) + theme_pubr() + rotate_x_text(90) #+ theme(panel.grid.major = element_line(colour = "black"))
require(ggsci)
require(ggpubr)
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) + geom_tile(color = 'black') + scale_fill_gsea()+ facet_wrap(~Contrast) + theme_pubr() #+ rotate_x_text(90) #+ theme(panel.grid.major = element_line(colour = "black"))
png(filename = "heatmap_HIF1pathways.png", width = 10, height = 4, pointsize = 14, res = 600, units = 'in')
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) + geom_tile(color = 'black') + scale_fill_gsea() + facet_wrap(~Contrast) + theme_pubr() + rotate_x_text(90) #+ theme(panel.grid.major = element_line(colour = "black"))
dev.off()
require(ggsci)
require(ggpubr)
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) + geom_tile(color = 'black', size = 2) + scale_fill_gsea()+ facet_wrap(~Contrast) + theme_pubr() #+ rotate_x_text(90) #+ theme(panel.grid.major = element_line(colour = "black"))
png(filename = "heatmap_HIF1pathways.png", width = 10, height = 4, pointsize = 14, res = 600, units = 'in')
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) + geom_tile(color = 'black', size = 2) + scale_fill_gsea() + facet_wrap(~Contrast) + theme_pubr() + rotate_x_text(90) #+ theme(panel.grid.major = element_line(colour = "black"))
dev.off()
require(ggsci)
require(ggpubr)
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) + geom_tile(color = 'black', size = 1) + scale_fill_gsea()+ facet_wrap(~Contrast) + theme_pubr() #+ rotate_x_text(90) #+ theme(panel.grid.major = element_line(colour = "black"))
png(filename = "heatmap_HIF1pathways.png", width = 10, height = 4, pointsize = 14, res = 600, units = 'in')
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) + geom_tile(color = 'black', size = 1) + scale_fill_gsea() + facet_wrap(~Contrast) + theme_pubr() + rotate_x_text(90) #+ theme(panel.grid.major = element_line(colour = "black"))
dev.off()
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) + geom_tile(color = 'black', size = 0.7) + scale_fill_gsea()+ facet_wrap(~Contrast) + theme_pubr() #+ rotate_x_text(90) #+ theme(panel.grid.major = element_line(colour = "black"))
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) + geom_tile(color = 'black', size = 0.7) + scale_fill_gsea() + facet_wrap(~Contrast) + theme_pubr() + rotate_x_text(90) #+ theme(panel.grid.major = element_line(colour = "black"))
require(ggsci)
require(ggpubr)
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) + geom_tile(color = 'black', size = 0.7) + scale_fill_gsea()+ facet_wrap(~Contrast) + theme_pubr() #+ rotate_x_text(90) #+ theme(panel.grid.major = element_line(colour = "black"))
png(filename = "heatmap_HIF1pathways.png", width = 10, height = 4, pointsize = 14, res = 600, units = 'in')
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) + geom_tile(color = 'black', size = 0.7) + scale_fill_gsea() + facet_wrap(~Contrast) + theme_pubr() + rotate_x_text(90) #+ theme(panel.grid.major = element_line(colour = "black"))
dev.off()
require(ggsci)
require(ggpubr)
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) + geom_tile(color = 'black', size = 0.3) + scale_fill_gsea()+ facet_wrap(~Contrast) + theme_pubr() #+ rotate_x_text(90) #+ theme(panel.grid.major = element_line(colour = "black"))
png(filename = "heatmap_HIF1pathways.png", width = 10, height = 4, pointsize = 14, res = 600, units = 'in')
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) + geom_tile(color = 'black', size = 0.3) + scale_fill_gsea() + facet_wrap(~Contrast) + theme_pubr() + rotate_x_text(90) #+ theme(panel.grid.major = element_line(colour = "black"))
dev.off()
require(ggsci)
require(ggpubr)
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) + geom_tile(color = 'black', size = 0.3) + scale_fill_gsea()+ facet_wrap(~Contrast) + theme_pubr() + rotate_x_text(90) #+ theme(panel.grid.major = element_line(colour = "black"))
png(filename = "heatmap_HIF1pathways.png", width = 10, height = 4, pointsize = 14, res = 600, units = 'in')
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) + geom_tile(color = 'black', size = 0.3) + scale_fill_gsea() + facet_wrap(~Contrast) + theme_pubr() + rotate_x_text(90) #+ theme(panel.grid.major = element_line(colour = "black"))
dev.off()
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) + geom_tile(color = 'black', size = 0.3) + scale_fill_colorbrewer("Blues")+ facet_wrap(~Contrast) + theme_pubr() + rotate_x_text(90) #+ theme(panel.grid.major = element_line(colour = "black"))
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) + geom_tile(color = 'black', size = 0.3) + scale_fill_brewer("Blues")+ facet_wrap(~Contrast) + theme_pubr() + rotate_x_text(90) #+ theme(panel.grid.major = element_line(colour = "black"))
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) + geom_tile(color = 'black', size = 0.3) + scale_fill_brewer()+ facet_wrap(~Contrast) + theme_pubr() + rotate_x_text(90) #+ theme(panel.grid.major = element_line(colour = "black"))
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) + geom_tile(color = 'black', size = 0.3)+ facet_wrap(~Contrast) + theme_pubr() + rotate_x_text(90) #+ theme(panel.grid.major = element_line(colour = "black"))
require(ggsci)
require(ggpubr)
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) + geom_tile(color = 'black', size = 0.3) + facet_wrap(~Contrast) + theme_pubr() + rotate_x_text(90) + scale_fill_gradient(low="white", high="blue")
png(filename = "heatmap_HIF1pathways.png", width = 10, height = 4, pointsize = 14, res = 600, units = 'in')
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) + geom_tile(color = 'black', size = 0.3) ++ facet_wrap(~Contrast) + theme_pubr() + rotate_x_text(90) + scale_fill_gradient(low="white", high="blue")
require(ggsci)
require(ggpubr)
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) + geom_tile(color = 'black', size = 0.3) + facet_wrap(~Contrast) + theme_pubr() + rotate_x_text(90) + scale_fill_gradient(low="white", high="blue")
png(filename = "heatmap_HIF1pathways.png", width = 10, height = 4, pointsize = 14, res = 600, units = 'in')
ggplot(PAlist2, aes(Algorithm, Pathway, fill=negativelog10FDR)) + geom_tile(color = 'black', size = 0.3) + facet_wrap(~Contrast) + theme_pubr() + rotate_x_text(90) + scale_fill_gradient(low="white", high="blue")
require(ggsci)
require(ggpubr)
PAlist2$Significant <- unlist(lapply(PAlist2$negativelog10FDR), function(x){if(x<1.303){return(0)}else{return(1)}})
PAlist2$Significant <- unlist(lapply(PAlist2$negativelog10FDR), FUN = function(x){if(x<1.303){return(0)}else{return(1)}})
PAlist2$Significant <- unlist(lapply(PAlist2$negativelog10FDR, function(x){if(x<1.303){return(0)}else{return(1)}})
require(ggsci)
require(ggpubr)
unlist(lapply(PAlist2$negativelog10FDR, function(x){if(x<1.303){return(0)}else{return(1)}}))
require(ggsci)
require(ggpubr)
PAlist2$Significant <- unlist(lapply(PAlist2$negativelog10FDR, function(x){if(x<1.303){return(0)}else{return(1)}}))
ggplot(PAlist2, aes(Algorithm, Pathway, fill=Significant)) + geom_tile(color = 'black', size = 0.3) + facet_wrap(~Contrast) + theme_pubr() + rotate_x_text(90) + scale_fill_gradient(low="white", high="blue")
png(filename = "heatmap_HIF1pathways.png", width = 10, height = 4, pointsize = 14, res = 600, units = 'in')
ggplot(PAlist2, aes(Algorithm, Pathway, fill=Significant)) + geom_tile(color = 'black', size = 0.3) + facet_wrap(~Contrast) + theme_pubr() + rotate_x_text(90) + scale_fill_gradient(low="white", high="blue")
require(ggsci)
require(ggpubr)
PAlist2$Significant <- unlist(lapply(PAlist2$negativelog10FDR, function(x){if(x<1.303){return(0)}else{return(1)}}))
ggplot(PAlist2, aes(Algorithm, Pathway, fill=Significant)) + geom_tile(color = 'black', size = 0.3) + facet_wrap(~Contrast) + theme_pubr() + rotate_x_text(90) + scale_fill_gradient(low="white", high="blue")
png(filename = "heatmap_HIF1pathways.png", width = 10, height = 4, pointsize = 14, res = 600, units = 'in')
ggplot(PAlist2, aes(Algorithm, Pathway, fill=Significant)) + geom_tile(color = 'black', size = 0.3) + facet_wrap(~Contrast) + theme_pubr() + rotate_x_text(90) + scale_fill_gradient(low="white", high="blue")
dev.off()
PAlist2 <- reshape2::acast(PAlist2, Pathway ~ Algorithm ~ Contrast, value.var = 'negativelog10FDR')
PAlist2[is.na(PAlist2)] <- 0
PAlist2
PAlist2 <- reshape2::acast(PAlist2, Pathway ~ Algorithm ~ Contrast, value.var = 'negativelog10FDR')
threshold <- 0.05
cwd <- getwd()
methods <- c("CAMERA", "LeapR", "PaintOmics", "ActivePathways", "mBONITA")
PAlist <- vector(mode = "list", length = length(methods))
names(PAlist) <- methods
PAlist[["CAMERA"]] <- read.csv(paste0(cwd, "/reactomeGSA-camera/camera_combinedPvalues.csv"), row.names = 1)
temp <- PAlist[["CAMERA"]]$FDR < threshold #PValue < 0.01
PAlist[["CAMERA"]] <- na.omit(PAlist[["CAMERA"]][temp,])
PAlist[["LeapR"]] <- read.csv(paste0(cwd, "/leapR/leapR_allResults.csv"))
temp <- PAlist[["LeapR"]]$BH_pvalue < threshold
PAlist[["LeapR"]] <- PAlist[["LeapR"]][temp,]
PAlist[["LeapR"]]$Pathway <- trimws(gsub("KEGG|_|\\d+$", " ", PAlist[["LeapR"]]$Pathway))
PAlist[["PaintOmics"]]<- as.data.frame(read.csv(paste0(cwd, "/paintomics/paintomics_allResults.csv"), row.names = 1))
colnames(PAlist[["PaintOmics"]])[1] <- "Pathway"
temp <- PAlist[["PaintOmics"]]$Combined.pValue.Fisher..FDR.BH < threshold
PAlist[["PaintOmics"]] <- PAlist[["PaintOmics"]][temp,]
PAlist[["ActivePathways"]]<- read.csv(paste0(cwd, "/ActivePathways/activePathways_allResults.csv"), row.names = NULL)
temp <- PAlist[["ActivePathways"]]$adjusted.p.val < threshold
PAlist[["ActivePathways"]] <- PAlist[["ActivePathways"]][temp,]
PAlist[["mBONITA"]]<- read.csv(paste0(cwd, "/mBonita_pvalues/mBonita_allResults.csv"), row.names = 1)
temp <- PAlist[["mBONITA"]]$FDR < threshold
PAlist[["mBONITA"]] <- PAlist[["mBONITA"]][temp,]
levels(PAlist$mBONITA$Contrast) <- c("X19O2NoCyA - X1O2PlusCyA", "X19O2NoCyA - X1O2NoCyA", "X1O2PlusCyA - X1O2NoCyA" )
#PAlist[[""]]<- read.csv(paste0(cwd, ""))
require(stringr)
makeVisList <- function(tempPAlist, contrast) {
visList <- tempPAlist
tempPAlist <-
lapply(tempPAlist, function(x) {
return(x[x$Contrast == contrast, ])
})
visList[["CAMERA"]] <-
unique(str_to_title(trimws(as.vector(tempPAlist[["CAMERA"]]$Pathway[tempPAlist[["CAMERA"]]$Method == "Combined"]))))
visList[["LeapR"]] <-
unique(str_to_title(as.vector(tempPAlist[["LeapR"]]$Pathway[tempPAlist[["LeapR"]]$Method == "Phosphoproteomics"]))) #NO COMBINED RESULTS YET
visList[["PaintOmics"]] <-
unique(str_to_title(trimws(as.vector(
tempPAlist[["PaintOmics"]]$Pathway.name
)))) #ALREADY FILTERED TO COMBINED PVALS IN PREVIOUS STEP
visList[["mBONITA"]] <-
unique(str_to_title(trimws(as.vector(tempPAlist[["mBONITA"]]$Pathway[tempPAlist[["mBONITA"]]$Method == "Concatenated"]))))
visList[["ActivePathways"]] <-
unique(str_to_title(trimws(as.vector(
tempPAlist[["ActivePathways"]]$Pathway
))))
visList <- lapply(visList, function(x){if(length(x) > 0){return(x)}else{return(NA)}})
visList <- visList[!is.na(visList)]
print(visList)
return(visList)
}
require(UpSetR)
require(ggplot2)
visList <- makeVisList(PAlist, "X19O2NoCyA - X1O2PlusCyA")
png(filename = "upset_X19O2NoCyA - X1O2PlusCyA.png", width = 4, height = 8, pointsize = 14, res = 600, units = 'in')
upset(fromList(visList), order.by = c("freq", "degree"), mb.ratio = c(0.55, 0.45), empty.intersections = NULL, point.size = 5, line.size = 1 , mainbar.y.label = "Intersections", sets.x.label = "Pathways", text.scale = c(2,2, 2, 2, 2, 2), number.angles = 0, main.bar.color = 'black', sets.bar.color = 'black', shade.color = 'white', matrix.color = 'black')
dev.off()
visList <- makeVisList(PAlist, "X19O2NoCyA - X1O2NoCyA")
png(filename = "upset_X19O2NoCyA - X1O2NoCyA.png", width = 4, height = 8, pointsize = 14, res = 600, units = 'in')
upset(fromList(visList), order.by = c("freq", "degree"), mb.ratio = c(0.55, 0.45), empty.intersections = NULL, point.size = 5, line.size = 1 , mainbar.y.label = "Intersections", sets.x.label = "Pathways", text.scale = c(2,2, 2, 2, 2, 2), number.angles = 0, main.bar.color = 'black', sets.bar.color = 'black', shade.color = 'white', matrix.color = 'black')
dev.off()
visList <- makeVisList(PAlist, "X1O2PlusCyA - X1O2NoCyA")
png(filename = "upset_X1O2PlusCyA - X1O2NoCyA.png", width = 4, height = 8, pointsize = 14, res = 600, units = 'in')
upset(fromList(visList), order.by = c("freq", "degree"), mb.ratio = c(0.55, 0.45), empty.intersections = NULL, point.size = 5, line.size = 1 , mainbar.y.label = "Intersections", sets.x.label = "Pathways", text.scale = c(2,2, 2, 2, 2, 2), number.angles = 0, main.bar.color = 'black', sets.bar.color = 'black', shade.color = 'white', matrix.color = 'black')
dev.off()
pathways <- as.vector(read.table("PATHWAYS IN HIF1A NETWORK KEGG IDS.txt", header=FALSE, fill=TRUE)[,1])
print(pathways)
gmt <- read.table('kegg_networks_edited.gmt', header=FALSE, fill=TRUE, sep = "\t")[,1:2]
colnames(gmt) <- c('Pathway', 'KEGGID')
gmt <- na.omit(gmt[gmt$KEGGID %in% pathways, c("KEGGID", "Pathway")])
rownames(gmt) <- gmt$KEGGID
print(gmt)
PAlist2 <- lapply(PAlist, function(x){return(x[x$Pathway %in% gmt$Pathway & x$Method %in% c("Concatenated", "Combined"), intersect(colnames(x), c('Contrast', 'Pathway',"Method", 'negativelog10FDR'))])})
PAlist2 <- Filter(function(x) dim(x)[1] > 0, PAlist2)
for (i in names(PAlist2)){
PAlist2[[i]]$Algorithm <- i
}
PAlist2 <- do.call(rbind,PAlist2)
rownames(PAlist2) <- 1:nrow(PAlist2)
PAlist2$Method <- 'Combined'
PAlist2
PAlist2 <- reshape2::acast(PAlist2, Pathway ~ Algorithm ~ Contrast, value.var = 'negativelog10FDR')
PAlist2[is.na(PAlist2)] <- 0
PAlist2 <- reshape2::melt(PAlist2)
PAlist2
PAlist2 <- reshape2::acast(PAlist2, Pathway ~ Algorithm ~ Contrast, value.var = 'negativelog10FDR')
colnames(PAlist2) <- c("Pathway", "Algorithm", "Contrast", "negativelog10FDR")
PAlist2
require(ggsci)
require(ggpubr)
PAlist2$Significant <- unlist(lapply(PAlist2$negativelog10FDR, function(x){if(x<1.303){return(0)}else{return(1)}}))
ggplot(PAlist2, aes(Algorithm, Pathway, fill=Significant)) + geom_tile(color = 'black', size = 0.3) + facet_wrap(~Contrast) + theme_pubr() + rotate_x_text(90) + scale_fill_gradient(low="white", high="blue")
png(filename = "heatmap_HIF1pathways.png", width = 10, height = 4, pointsize = 14, res = 600, units = 'in')
ggplot(PAlist2, aes(Algorithm, Pathway, fill=Significant)) + geom_tile(color = 'black', size = 0.3) + facet_wrap(~Contrast) + theme_pubr() + rotate_x_text(90) + scale_fill_gradient(low="white", high="blue")
dev.off()
ggplot(PAlist2, aes(Algorithm, Pathway, fill=Significant)) + geom_tile(color = 'black', size = 0.3) + facet_wrap(~Contrast) + theme_pubr() + rotate_x_text(90) + scale_fill_discrete(low="white", high="blue")
?scale_fill_discrete
ggplot(PAlist2, aes(Algorithm, Pathway, fill=Significant)) + geom_tile(color = 'black', size = 0.3) + facet_wrap(~Contrast) + theme_pubr() + rotate_x_text(90) + ggpar(p, palette = "npg")
ggplot(PAlist2, aes(Algorithm, Pathway, fill=Significant)) + geom_tile(color = 'black', size = 0.3) + facet_wrap(~Contrast) + theme_pubr() + rotate_x_text(90) + ggpar(palette = "npg")
p1 <- ggplot(PAlist2, aes(Algorithm, Pathway, fill=Significant)) + geom_tile(color = 'black', size = 0.3) + facet_wrap(~Contrast) + theme_pubr() + rotate_x_text(90)
ggpar(p1, palette = "npg")
PAlist2$Significant <- as.factor(unlist(lapply(PAlist2$negativelog10FDR, function(x){if(x<1.303){return(0)}else{return(1)}})))
p1 <- ggplot(PAlist2, aes(Algorithm, Pathway, fill=Significant)) + geom_tile(color = 'black', size = 0.3) + facet_wrap(~Contrast) + theme_pubr() + rotate_x_text(90)
ggpar(p1, palette = "npg")
require(ggsci)
require(ggpubr)
PAlist2$Significant <- as.factor(unlist(lapply(PAlist2$negativelog10FDR, function(x){if(x<1.303){return(FALSE)}else{return(TRUE)}})))
p1 <- ggplot(PAlist2, aes(Algorithm, Pathway, fill=Significant)) + geom_tile(color = 'black', size = 0.3) + facet_wrap(~Contrast) + theme_pubr() + rotate_x_text(90)
ggpar(p1, palette = "npg")
png(filename = "heatmap_HIF1pathways.png", width = 10, height = 4, pointsize = 14, res = 600, units = 'in')
p1 <- ggplot(PAlist2, aes(Algorithm, Pathway, fill=Significant)) + geom_tile(color = 'black', size = 0.3) + facet_wrap(~Contrast) + theme_pubr() + rotate_x_text(90) + scale_fill_gradient(low="white", high="blue")
ggpar(p1, palette = "npg")
dev.off()
require(ggsci)
require(ggpubr)
PAlist2$Significant <- as.factor(unlist(lapply(PAlist2$negativelog10FDR, function(x){if(x<1.303){return(FALSE)}else{return(TRUE)}})))
p1 <- ggplot(PAlist2, aes(Algorithm, Pathway, fill=Significant)) + geom_tile(color = 'black', size = 0.3) + facet_wrap(~Contrast) + theme_pubr() + rotate_x_text(90)
ggpar(p1, palette = "npg")
png(filename = "heatmap_HIF1pathways.png", width = 10, height = 4, pointsize = 14, res = 600, units = 'in')
p1 <- ggplot(PAlist2, aes(Algorithm, Pathway, fill=Significant)) + geom_tile(color = 'black', size = 0.3) + facet_wrap(~Contrast) + theme_pubr() + rotate_x_text(90) + scale_fill_gradient(low="white", high="blue")
ggpar(p1, palette = "simpsons")
dev.off()
require(ggsci)
require(ggpubr)
PAlist2$Significant <- as.factor(unlist(lapply(PAlist2$negativelog10FDR, function(x){if(x<1.303){return(FALSE)}else{return(TRUE)}})))
p1 <- ggplot(PAlist2, aes(Algorithm, Pathway, fill=Significant)) + geom_tile(color = 'black', size = 0.3) + facet_wrap(~Contrast) + theme_pubr() + rotate_x_text(90)
ggpar(p1, palette = "npg")
png(filename = "heatmap_HIF1pathways.png", width = 10, height = 4, pointsize = 14, res = 600, units = 'in')
p1 <- ggplot(PAlist2, aes(Algorithm, Pathway, fill=Significant)) + geom_tile(color = 'black', size = 0.3) + facet_wrap(~Contrast) + theme_pubr() + rotate_x_text(90) + scale_fill_gradient(low="white", high="blue")
ggpar(p1, palette = "npg")
dev.off()
p1 <- ggplot(PAlist2, aes(Algorithm, Pathway, fill=Significant)) + geom_tile(color = 'black', size = 0.3) + facet_wrap(~Contrast) + theme_pubr() + rotate_x_text(90) + scale_fill_brewer('Greys')
p1
require(ggsci)
require(ggpubr)
PAlist2$Significant <- as.factor(unlist(lapply(PAlist2$negativelog10FDR, function(x){if(x<1.303){return(FALSE)}else{return(TRUE)}})))
p1 <- ggplot(PAlist2, aes(Algorithm, Pathway, fill=Significant)) + geom_tile(color = 'black', size = 0.3) + facet_wrap(~Contrast) + theme_pubr() + rotate_x_text(90) + scale_fill_brewer('Greys')
#ggpar(p1, palette = "npg")
png(filename = "heatmap_HIF1pathways.png", width = 10, height = 4, pointsize = 14, res = 600, units = 'in')
p1
dev.off()
require(ggsci)
require(ggpubr)
PAlist2$Significant <- as.factor(unlist(lapply(PAlist2$negativelog10FDR, function(x){if(x<1.303){return(FALSE)}else{return(TRUE)}})))
p1 <- ggplot(PAlist2, aes(Algorithm, Pathway, fill=Significant)) + geom_tile(color = 'black', size = 0.3) + facet_wrap(~Contrast) + theme_pubr() + rotate_x_text(90) + scale_fill_brewer('Greys')
#ggpar(p1, palette = "npg")
png(filename = "heatmap_HIF1pathways.png", width = 10, height = 4, pointsize = 14, res = 600, units = 'in')
p1
dev.off()
print(p1)
require(ggsci)
require(ggpubr)
PAlist2$Significant <- as.factor(unlist(lapply(PAlist2$negativelog10FDR, function(x){if(x<1.303){return(FALSE)}else{return(TRUE)}})))
p1 <- ggplot(PAlist2, aes(Algorithm, Pathway, fill=Significant)) + geom_tile(color = 'black', size = 0.3) + facet_wrap(~Contrast) + theme_pubr() + rotate_x_text(90) + scale_fill_brewer()
#ggpar(p1, palette = "npg")
png(filename = "heatmap_HIF1pathways.png", width = 10, height = 4, pointsize = 14, res = 600, units = 'in')
p1
dev.off()
print(p1)
levels(PAlist2$Contrast)
